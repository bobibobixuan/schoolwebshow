<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>安息之云山峰代码详情</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding-top: 100px; /* 为导航条预留空间，防止遮挡 */
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 25px 0;
            background: linear-gradient(135deg, #f8c471 0%, #e67e22 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 1;
        }
        
        header h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
    text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
    color: #7BDEFC;
        }
        
        header p {
            font-size: 1.1rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .back-btn {
            display: inline-block;
            margin-top: 15px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: 600;
            transition: background-color 0.3s;
            position: relative;
            z-index: 10;
        }
        
        .back-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }
        
        .level-nav {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            position: fixed; /* 改为fixed定位，固定在顶部 */
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: calc(100% - 40px);
            max-width: 1200px;
            z-index: 1000; /* 提高z-index确保在最上层 */
            transition: all 0.3s ease;
            max-height: 2000px;
            overflow: hidden;
        }
        
        /* 收起状态 */
        .level-nav.collapsed {
            max-height: 70px;
            cursor: pointer;
            padding: 15px 20px;
            width: auto; /* 收起时宽度自适应 */
            min-width: 300px;
        }
        
        .level-nav.collapsed:hover {
            background-color: #f8f9fa;
        }
        
        /* 导航标题区域 */
        .nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
        }
        
        .nav-header h2 {
            color: #2c3e50;
            font-size: 1.5rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .nav-header h2 i {
            color: #e67e22;
            font-size: 1.3rem;
            transition: transform 0.3s;
        }
        
        .level-nav.collapsed .nav-header h2 i {
            transform: rotate(-90deg);
        }
        
        .collapse-toggle {
            background: none;
            border: none;
            color: #7f8c8d;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .collapse-toggle:hover {
            background-color: #f0f0f0;
            color: #e67e22;
        }
        
        .level-nav.collapsed .collapse-toggle .toggle-text {
            display: none;
        }
                .level-nav.collapsed .collapse-toggle .toggle-text {
            display: none;
        }
        
        /* 在这里添加B站按钮样式开始 */
        /* B站按钮样式 */
        .bilibili-btn-container {
            text-align: center;
            margin: 20px 0;
        }
        
        .bilibili-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            background-color: #fb7299;
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.1rem;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(251, 114, 153, 0.3);
            border: none;
            cursor: pointer;
        }
        
        .bilibili-btn:hover {
            background-color: #ff8ab0;
            transform: translateY(-3px);
            box-shadow: 0 6px 18px rgba(251, 114, 153, 0.4);
            color: white;
            text-decoration: none;
        }
        
        .bilibili-btn:active {
            transform: translateY(1px);
            box-shadow: 0 2px 8px rgba(251, 114, 153, 0.3);
        }
        
        .bilibili-btn i {
            font-size: 1.3rem;
        }
        
        /* 移动端适配 */
        @media (max-width: 768px) {
            .bilibili-btn {
                padding: 12px 24px;
                font-size: 1rem;
                width: 90%;
                max-width: 300px;
            }
            
            .bilibili-btn span {
                font-size: 0.95rem;
            }
        }
        
        @media (max-width: 480px) {
            .bilibili-btn {
                padding: 10px 20px;
                font-size: 0.9rem;
            }
            
            .bilibili-btn i {
                font-size: 1.1rem;
            }
        }
        /* 在这里添加B站按钮样式结束 */
        
        .nav-content {
            transition: opacity 0.3s, transform 0.3s;
            opacity: 1;
            transform: translateY(0);
        }
        .nav-content {
            transition: opacity 0.3s, transform 0.3s;
            opacity: 1;
            transform: translateY(0);
        }
        
        .level-nav.collapsed .nav-content {
            opacity: 0;
            transform: translateY(-10px);
            pointer-events: none;
        }
        
        .search-container {
            position: relative;
            margin-bottom: 20px;
        }
        
        #searchInput {
            width: 100%;
            padding: 12px 20px;
            padding-left: 45px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
            background-color: #f8f9fa;
        }
        
        #searchInput:focus {
            outline: none;
            border-color: #e67e22;
            background-color: white;
            box-shadow: 0 0 0 3px rgba(230, 126, 34, 0.1);
        }
        
        .search-icon {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #7f8c8d;
            font-size: 1.2rem;
        }
        
        .search-results {
            max-height: 400px;
            overflow-y: auto;
            border-radius: 8px;
            border: 1px solid #eaeaea;
            background-color: #f8f9fa;
        }
        
        .search-results.hidden {
            display: none;
        }
        
        .level-result {
            display: block;
            padding: 12px 20px;
            text-decoration: none;
            color: #2c3e50;
            border-bottom: 1px solid #eaeaea;
            transition: all 0.2s;
        }
        
        .level-result:hover {
            background-color: #e8f4fc;
            color: #e67e22;
        }
        
        .level-result:last-child {
            border-bottom: none;
        }
        
        .level-result .level-id {
            display: inline-block;
            width: 30px;
            color: #7f8c8d;
            font-weight: 600;
        }
        
        .level-result .level-name {
            font-weight: 500;
        }
        
        .no-results {
            padding: 20px;
            text-align: center;
            color: #7f8c8d;
            font-style: italic;
        }
        
        .search-stats {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #7f8c8d;
            text-align: center;
        }
        
        .level-content {
            margin-bottom: 40px;
        }
        
        .level-section {
            background-color: white;
            border-radius: 10px;
            padding: 0;
            margin-bottom: 25px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            overflow: hidden;
            position: relative;
        }
        
        .level-header {
            background: linear-gradient(to right, #3498db, #2ecc71);
            color: white;
            padding: 20px 25px;
        }
        
        .level-header h3 {
            font-size: 1.5rem;
            margin: 0;
        }
        
        .code-container {
            position: relative;
            padding: 25px;
        }
        
        .code-container:hover .copy-btn {
            opacity: 1;
        }
        
        pre {
            background-color: #2d3436;
            color: #dfe6e9;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.5;
            margin: 0;
            tab-size: 4;
            white-space: pre-wrap;
            max-height: 500px;
            overflow-y: auto;
        }
        
        .copy-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            opacity: 0;
            transition: opacity 0.3s, background-color 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 10;
        }
        
        .copy-btn:hover {
            background-color: #2980b9;
        }
        
        .copy-btn.show {
            opacity: 1;
        }
        
        /* 删除每个关卡内的返回页首按钮 */
        .back-to-top-btn {
            display: none; /* 隐藏所有关卡内的返回页首按钮 */
        }
        
        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            border-top: 1px solid #ddd;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        /* 复制成功提示 - 电脑端样式 */
        .copy-notification {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: #2ecc71;
            color: white;
            padding: 15px 25px;
            border-radius: 5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.3s, transform 0.3s;
            z-index: 1000;
            max-width: 300px;
        }
        
        .copy-notification.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* 浮动返回顶部按钮 - 电脑端样式 */
        .floating-top-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background-color: #e67e22;
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 50px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
            z-index: 999;
            opacity: 0;
            transform: translateY(20px);
        }
        
        .floating-top-btn.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .floating-top-btn:hover {
            background-color: #d35400;
            transform: translateY(-3px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
        }

        /* 装备图片样式 */
        .equipment-image {
            text-align: center;
            margin: 20px 0;
            padding: 0 25px 25px;
        }
        
        .equipment-image img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid #ddd;
        }
        .image-caption {
            margin-top: 10px;
            color: #7f8c8d;
            font-style: italic;
            font-size: 0.9rem;
        }
		       /* 视频容器样式 */
       .video-container {
           text-align: center;
           margin: 20px 0;
           padding: 0 25px 25px;
       }

       .video-container h4 {
           color: #2c3e50;
           margin-bottom: 15px;
           font-size: 1.2rem;
       }

       .video-wrapper {
           position: relative;
           width: 100%;
           max-width: 800px;
           margin: 0 auto;
           border-radius: 8px;
           overflow: hidden;
           box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
       }

       .video-wrapper iframe,
       .video-wrapper video {
           width: 100%;
           height: 450px;
           display: block;
           border: none;
       }

       .video-caption {
           margin-top: 10px;
           color: #7f8c8d;
           font-style: italic;
           font-size: 0.9rem;
       }

       /* 移动端适配 */
       @media (max-width: 768px) {
           .video-wrapper iframe,
           .video-wrapper video {
               height: 300px;
           }
           
           .video-container {
               padding: 0 15px 15px;
           }
       }

       @media (max-width: 480px) {
           .video-wrapper iframe,
           .video-wrapper video {
               height: 200px;
           }
           
           .video-container h4 {
               font-size: 1.1rem;
           }
       }
        /* 多代码块样式 */
        .multi-code-container {
            margin-bottom: 20px;
        }
        
        .code-block-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 10px;
            padding-left: 5px;
            border-left: 4px solid #3498db;
        }
        
        .sub-code-container {
            position: relative;
            margin-bottom: 30px;
            border: 1px solid #eaeaea;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .sub-code-container:last-child {
            margin-bottom: 0;
        }
        
        .sub-code-container:hover .copy-btn {
            opacity: 1;
        }
        
        /* 电脑端特定样式 */
        @media (min-width: 769px) {
            .copy-notification {
                bottom: 20px;
                left: 20px;
                max-width: 300px;
            }
            
            .floating-top-btn {
                bottom: 30px;
                right: 30px;
            }
            
            .back-btn {
                z-index: 10;
            }
        }
        
        /* 移动端响应式设计 */
        @media (max-width: 768px) {
            body {
                padding-top: 80px;
            }
            
            .level-nav {
                top: 10px;
                width: calc(100% - 20px);
                padding: 15px;
            }
            
            .level-nav.collapsed {
                max-height: 60px;
                padding: 10px 15px;
                min-width: 250px;
            }
            
            .level-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .search-results {
                max-height: 300px;
            }
            
            .copy-btn {
                opacity: 1;
                position: relative;
                top: auto;
                right: auto;
                margin-top: 15px;
                width: 100%;
                justify-content: center;
            }
            
            .nav-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .collapse-toggle {
                align-self: flex-end;
            }
            
            .level-nav.collapsed .nav-header h2 {
                font-size: 1.3rem;
            }
            
            /* 移动端复制弹窗样式 */
            .copy-notification {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) translateY(10px);
                width: 90%;
                max-width: 280px;
                text-align: center;
                padding: 15px 20px;
                bottom: auto;
                right: auto;
                font-size: 0.9rem;
                z-index: 1001;
            }
            
            .copy-notification.show {
                transform: translate(-50%, -50%) translateY(0);
            }
            
            /* 移动端返回顶部按钮 */
            .floating-top-btn {
                right: 15px;
                bottom: 15px;
                padding: 10px 15px;
                font-size: 0.9rem;
                z-index: 1000;
            }
            
            /* 移动端header确保按钮可点击 */
            header {
                padding: 20px 15px;
                position: relative;
            }
            
            .back-btn {
                padding: 8px 16px;
                font-size: 0.9rem;
                position: relative;
                z-index: 10;
                margin-top: 10px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding-top: 70px;
            }
            
            .level-nav {
                top: 5px;
                width: calc(100% - 10px);
                padding: 12px;
            }
            
            .level-nav.collapsed {
                max-height: 55px;
                padding: 8px 12px;
                min-width: 200px;
            }
            
            .nav-header h2 {
                font-size: 1.2rem;
            }
            
            .copy-notification {
                width: 85%;
                max-width: 250px;
                padding: 12px 15px;
                font-size: 0.85rem;
            }
            
            .floating-top-btn {
                right: 10px;
                bottom: 10px;
                padding: 8px 12px;
                font-size: 0.8rem;
            }
            
            header h1 {
                font-size: 2rem;
            }
            
            header p {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header id="page-top">
            <h1>安息之云山峰</h1>
            <p>安息之云山峰代码，可点击复制<br>
				<span style="color: #001AE7">有些关卡有需要特定的装备，请自行看代码选择装备</span></p>
			<p span style="color: #FF0000">还没做多少，下面的只是预留项</p>
            <a href="index.html" class="back-btn"><i class="fas fa-arrow-left"></i> 返回目录页</a>
        </header>
        
        <section class="level-nav collapsed" id="levelNav">
            <div class="nav-header">
                <h2><i class="fas fa-search"></i> 关卡搜索导航</h2>
                <button class="collapse-toggle" id="collapseToggle">
                    <i class="fas fa-chevron-down" id="collapseIcon"></i>
                    <span class="toggle-text">收起搜索栏</span>
                </button>
            </div>
            
            <div class="nav-content">
                <div class="search-container">
                    <i class="fas fa-search search-icon"></i>
                    <input type="text" id="searchInput" placeholder="输入关卡名称进行搜索">
                </div>
                <div class="search-results hidden" id="searchResults">
                    <!-- 搜索结果将在这里显示 -->
                </div>
                <div class="search-stats" id="searchStats">
                    共109个关卡，输入关键词搜索
              </div>
            </div>
        </section>
        
        <div class="level-content" id="levelContent">
            <!-- 关卡代码将通过JavaScript动态生成 -->
        </div>
    </div>
    
    <!-- 浮动返回顶部按钮 -->
    <button class="floating-top-btn" id="floatingTopBtn">
        <i class="fas fa-arrow-up"></i> 返回页首
    </button>
    
    <footer class="footer">
        <p>安息之云山峰关卡代码详情</p>
        <p style="color: #FF0000">注意：代码仅供参考，不建议直接抄！</p>
    </footer>
    
    <div class="copy-notification" id="copyNotification">代码已复制到<a href="#">剪贴板！</a></div>

    <script>
        const levelCodes = [
            {
                id: 1,
                name: "峭壁追逐",
                code: `while True:
    sb = hero.findNearest(hero.findFriends())
    if sb:
        hero.move(sb.pos)`
            },
            {
                id: 2,
                name: "激流回旋",
                code: `gems = hero.findItems()
while hero.pos.x < 20:
    hero.move({'x': 20, 'y': 35})
while hero.pos.x < 25:
    gem0 = gems[0]
    hero.move(gem0.pos)
while hero.pos.x < 30:
    hero.move({'x': 30, 'y': 35})
while hero.pos.x < 35:
    gem0 = gems[1]
    hero.move(gem0.pos)
while hero.pos.x < 40:
    hero.move({'x': 40, 'y': 35})
while hero.pos.x < 45:
    gem0 = gems[2]
    hero.move(gem0.pos)
while hero.pos.x < 50:
    hero.move({'x': 50, 'y': 35})
while hero.pos.x < 55:
    gem0 = gems[3]
    hero.move(gem0.pos)`
            },
            {
                id: 3,
                name: "黑钻石",
                code: `while True:
    gem = hero.findNearestItem()
    if gem:
        clear = hero.isPathClear(hero.pos, gem.pos)
    else:
        clear = False
    if clear:
        lastpos = {'x': hero.pos.x, 'y': hero.pos.y}
        hero.moveXY(gem.pos.x, gem.pos.y)
    else:
        hero.moveXY(lastpos.x, lastpos.y)
        hero.moveXY(40, 35)`
            },
            {
                id: 4,
                name: "舞蹈人生",
                code: `friend = hero.findNearest(hero.findFriends())
diffx = friend.pos.x - hero.pos.x
diffy = friend.pos.y - hero.pos.y
while True:
    target = {'x': friend.pos.x - diffx, 'y': friend.pos.y - diffy}
    hero.move(target)`
            },
            {
                id: 5,
                name: "高山拉力（堆移速或选跑得快的英雄）",
                code: `invis = -5
while True:
    if (hero.now() - invis > 4):
        if (hero.canCast('haste', self)):
            hero.cast('haste', self)
    if (hero.canCast('invisibility', self)):
        hero.cast('invisibility', self)
        invis = hero.now()
    direction = Vector(hero.pos.x + 30, hero.pos.y)
    enemy = hero.findNearest(hero.findByType('scout'))
    hero.move(direction)`
            },
            {
                id: 6,
                name: "兽人山谷挖宝",
                code: `while hero.now() < 30:
    item = hero.findNearestItem()
    if item:
        if (hero.isReady("jump") and hero.distanceTo > 15):
            hero.jumpTo(item.pos)
        else:
            hero.move(item.pos)
    if (hero.gold > 59):
        break
if (hero.isReady("jump")):
    hero.jumpTo({'x': 21, 'y': 38})
hero.moveXY(21, 38)
while hero.pos.x > 16:
    hero.move({'x': 15, 'y': 38})
hero.buildXY('fence', 20, 38)`
            },
            {
                id: 8,
                name: "安息之云指挥官",
				code: `while hero.gold > hero.costOf("soldier"):
    hero.summon("soldier")
    
soldiers = hero.findFriends()
soldierIndex = 0
while soldierIndex<len(soldiers):
    soldier = soldiers[soldierIndex]
    hero.command(soldier, "move", {"x": 50, "y": 40})
    soldierIndex+=1
hero.moveXY(50,40)`
            },
            {
                id: 9,
                name: "佣兵山",
                code: `while True:
    item = hero.findNearestItem()
    if (item):
        hero.move(item.pos)
    if hero.gold > hero.costOf("soldier"):
        hero.summon("soldier")
    enemy = hero.findNearestEnemy()
    if enemy:
        soldiers = hero.findFriends()
        soldierIndex = 0
        while (soldierIndex < len(soldiers)):
            soldier = soldiers[soldierIndex]
            hero.command(soldier, "attack", enemy)
            soldierIndex += 1`
            },
            {
                id: 10,
                name: "木材守卫",
                code: `while True:
    item = hero.findNearestItem()
    if (item):
        if (hero.isReady("jump")):
            hero.jumpTo({'x': item.pos.x, 'y': item.pos.y})
        else:
            hero.move(item.pos)
    if hero.gold > hero.costOf("soldier"):
        hero.summon("soldier")
    for friend in hero.findFriends():
        down = True;
        if friend.type == "soldier":
            enemy = friend.findNearestEnemy()
            if (enemy):
                hero.command(friend, "attack", enemy)
            elif (down):
                hero.command(friend, "move", {'x': 69, 'y': 42})
                down = False
            else:
                hero.command(friend, "move", {'x': 69, 'y': 53})
                down = True`
            },
            {
                id: 11,
                name: "木材的叛徒",
                code: `while True:
    item = hero.findNearestItem()
    if item:
        hero.move(item.pos)
    if hero.gold > hero.costOf("soldier"):
        hero.summon("soldier")
    for friend in hero.findFriends():
        if friend.type == "soldier":
            enemy = friend.findNearestEnemy()
            if (enemy):
                hero.command(friend, "attack", enemy)
            else:
                hero.command(friend, "move", {'x': 85, 'y': 46})`
            },
            {
                id: 12,
                name: "士兵的痛苦之源",
                code: `def commandSoldier(soldier, index):
    target = hero.findNearestEnemy()
    if (target and index == 0):
        hero.command(soldier, "attack", target)
    else:
        hero.command(soldier, "move", {'x': 15, 'y': 30})
while True:
    friends = hero.findFriends()
    for index, friend in enumerate(friends):
        commandSoldier(friend, index)`
            },
            {
                id: 13,
                name: "动物园管理员",
                code: `points = []
points[0] = {"x": 33, "y": 42}
points[1] = {"x": 47, "y": 42}
points[2] = {"x": 33, "y": 26}
points[3] = {"x": 47, "y": 26}
while hero.gold < 80:
    item = hero.findNearestItem()
    if (item):
        if (hero.isReady("jump")):
            hero.jumpTo({'x': item.pos.x, 'y': item.pos.y})
        else:
            hero.move(item.pos)
for i in range(4):
    hero.summon("soldier")
while True:
    friends = hero.findFriends()
    for j in range(len(friends)):
        point = points[j]
        friend = friends[j]
        enemy = friend.findNearestEnemy()
        if enemy and enemy.team == "ogres" and friend.distanceTo(enemy) < 5:
            hero.command(friend, 'attack', enemy)
        else:
            hero.command(friend, 'move', point)`
            },
            {
                id: 14,
                name: "壮烈牺牲",
                code: `while hero.gold < 80:
    item = hero.findNearestItem()
    if (item):
        if (hero.isReady("jump")):
            hero.jumpTo({'x': item.pos.x, 'y': item.pos.y})
        else:
            hero.move(item.pos)
for i in range(4):
    hero.summon("soldier")
points = []
points[0] = {"x": 13, "y": 73}
points[1] = {"x": 51, "y": 73}
points[2] = {"x": 51, "y": 53}
points[3] = {"x": 90, "y": 52}
friends = hero.findFriends()
for j in range(len(friends)):
    point = points[j]
    friend = friends[j]
    enemy = friend.findNearestEnemy()
    hero.command(friend, 'move', point)`
            },
            {
                id: 15,
                name: "混战",
                multiCode: true, // 标记为多代码块关卡
                codes: [
                    {
                        title: "第一关",
                        code: `while True:
    item = hero.findNearestItem()
    if (item):
        if (hero.isReady("jump")):
            hero.jumpTo({'x': item.pos.x, 'y': item.pos.y})
        else:
            hero.move(item.pos)
    if hero.gold > hero.costOf("soldier"):
        hero.summon("soldier")
    enemy = hero.findNearestEnemy()
    if enemy:
        soldiers = hero.findFriends()
        soldierIndex = 0
        while (soldierIndex < len(soldiers)):
            soldier = soldiers[soldierIndex]
            hero.command(soldier, "attack", enemy)
            soldierIndex += 1`
                    },
                    {
                        title: "第二关",
                        code: `还没做`
                    }
                ]
            },
            {
                id: 16,
                name: "宝藏洞穴",
                code: `hero.buildXY('fire-trap', 64, 44)
hero.moveXY(73, 15)
hero.moveXY(42, 11)
hero.moveXY(46, 9)
hero.wait(1)
hero.moveXY(14, 37)
item = hero.findNearestItem()
hero.jumpTo(Vector(17, 37))
while item:
    hero.move(item.pos)
    item = hero.findNearestItem()
hero.moveXY(73, 15)`
            },
            {
                id: 17,
                name: "借刀",
                code: `def commandTroops():
    for index, friend in enumerate(hero.findFriends()):
        if friend.type == 'archer':
            CommandArcher(friend)
def CommandArcher(soldier):
    target = None
    leastHealth = 0
    enemyIndex = 0
    enemies = hero.findEnemies()
    while enemyIndex < len(enemies):
        if (enemies[enemyIndex].health > leastHealth):
            leastHealth = enemies[enemyIndex].health
            target = enemies[enemyIndex]
        enemyIndex = enemyIndex + 1
    if target:
        hero.command(soldier, "attack", target)
while True:
    commandTroops()`
            },
            {
                id: 18,
                name: "戒指运送人",
                code: `def findSoldierOffset(soldiers, i):
    soldier = soldiers[i]
    angle = i * 360 / len(soldiers)
    return radialToCartesian(5, angle)
def radialToCartesian(radius, degrees):
    radians = Math.PI / 180 * degrees
    xOffset = radius * Math.cos(radians)
    yOffset = radius * Math.sin(radians)
    return {"x": xOffset, "y": yOffset}
peasant = hero.findByType("peasant")[0]
soldiers = hero.findByType("soldier")
while True:
    for index in range(len(soldiers)):
        offset = findSoldierOffset(soldiers, index)
        x = offset.x + peasant.pos.x
        y = offset.y + peasant.pos.y
        hero.command(soldiers[index], "move", {'x': x, 'y': y})
    hero.move({"x": hero.pos.x + 0.2, "y": hero.pos.y})`
            },
            {
                id: 19,
                name: "躁动的死亡",
                code: `while True:
    flag = hero.findFlag("green")
    enemy=hero.findNearestEnemy()
    item=hero.findNearestItem()
    if flag:
        hero.pickUpFlag(flag)
    if enemy and enemy.health >0 and hero.distanceTo(enemy)<10:
        if hero.isReady("bash"):
            hero.bash(enemy)
        elif hero.canCast("chain-lightning", enemy):
            hero.cast("chain-lightning", enemy)
        else:
            hero.attack(enemy)
    if item:
        hero.move(item.pos)
    if hero.gold > hero.costOf("soldier"):
        hero.summon("soldier")
    for friend in hero.findFriends():
        enemy=friend.findNearestEnemy()
        if enemy:
            hero.command(friend,"attack",enemy)
        else:
            hero.command(friend,"move",{'x':hero.pos.x-7,'y':hero.pos.y-7})`
            },
            {
                id: 20,
                name: "狩猎派对",
                code: `index = 0
while True:
    friends = hero.findFriends()
    enemy = hero.findNearestEnemy()
    if enemy and hero.distanceTo(enemy) < 20:
        if (hero.isReady("jump") and hero.distanceTo(enemy) > 10):
            hero.jumpTo(enemy.pos)
        elif (hero.isReady("cleave")):
            hero.cleave(enemy)
        elif (hero.isReady("bash")):
            hero.bash(enemy)
        elif (hero.isReady("power-up")):
            hero.powerUp()
            hero.attack(enemy)
        else:
            hero.attack(enemy)
    else:
        if (hero.now() < 7):
            pos = {'x': 87, 'y': 49}
        else:
            pos = {'x': 12, 'y': 47}
        if (hero.isReady("jump")):
            hero.jumpTo(pos)
        else:
            hero.move(pos)
    for j in range(len(friends)):
        friend = friends[j]
        if (friend.pos.y > 46 and hero.now() < 5):
            pos = {'x': 12, 'y': 64}
        elif (friend.pos.y > 46):
            if (friend.type != 'archer'):
                pos = {'x': 61, 'y': 67}
            else:
                pos = {'x': 42, 'y': 67}
        else:
            if (friend.type != 'archer'):
                pos = {'x': 45, 'y': 32}
            else:
                pos = {'x': 51, 'y': 32}
        enemy = friend.findNearestEnemy()
        if (friend.health < 29 or (enemy and friend.type == 'archer' and friend.distanceTo(enemy) < 22)):
            hero.command(friend, 'move', {'x': 11, 'y': 47})
        elif enemy and friend.distanceTo(enemy) < 20:
            hero.command(friend, 'attack', enemy)
        else:
            hero.command(friend, 'move', pos)`
            },
            {
                id: 21,
                name: "关键力量",
                code: `def onSpawn():
    while True:
        pet.moveXY(25, 20)
        pet.moveXY(25, 55)
        pet.moveXY(55, 55)
        pet.moveXY(55, 20)
        pet.moveXY(hero.pos.x, hero.pos.y)
def pickUpNearestCoin():
    items = hero.findItems()
    nearestCoin = hero.findNearest(items)
    if nearestCoin:
        hero.move(nearestCoin.pos)
def summonSoldier():
    if hero.gold>hero.costOf("soldier"):
        hero.summon("soldier")
    pass
def skillAndAttack():
    enemy=hero.findNearestEnemy()
    if enemy and enemy.health>0 and hero.distanceTo(enemy)<5:
        if hero.isReady("bash"):
            hero.bash(enemy)
        elif hero.canCast("chain-lightning",enemy):
            hero.cast("chain-lightning",enemy)
        else:
            hero.attack(enemy)
def commandSoldiers():
    for soldier in hero.findFriends():
        enemy = soldier.findNearestEnemy()
        if enemy:
            hero.command(soldier, "attack", enemy)
while True:
    pickUpNearestCoin()
    summonSoldier()
    commandSoldiers()
    skillAndAttack()`
            },
            {
                id: 22,
                name: "双生花",
                code: `def summonSoldiers():
    if hero.gold >= hero.costOf("soldier"):
        hero.summon("soldier")
def commandSoldiers():
    for soldier in hero.findByType("soldier"):
        enemy = soldier.findNearestEnemy()
        if enemy:
            hero.command(soldier, "attack", enemy)
def pickUpNearestCoin():
    items = hero.findItems()
    nearestCoin = hero.findNearest(items)
    if nearestCoin:
        hero.move(nearestCoin.pos)
peasant = hero.findByType("peasant")[0]
while True:
    summonSoldiers()
    commandSoldiers()
    pickUpNearestCoin()`
            },
            {
                id: 23,
                name: "花的几何学",
                code: `def drawCircle(x, y, size):
    angle = 0
    hero.toggleFlowers(False)
    while angle <= Math.PI * 2:
        newX = x + (size * Math.cos(angle))
        newY = y + (size * Math.sin(angle))
        hero.moveXY(newX, newY)
        hero.toggleFlowers(True)
        angle += 0.2
def drawSquare(x, y, size):
    hero.toggleFlowers(False)
    cornerOffset = size / 2
    hero.moveXY(x - cornerOffset, y - cornerOffset)
    hero.toggleFlowers(True)
    hero.moveXY(x + cornerOffset, y - cornerOffset)
    hero.moveXY(x + cornerOffset, y + cornerOffset)
    hero.moveXY(x - cornerOffset, y + cornerOffset)
    hero.moveXY(x - cornerOffset, y - cornerOffset)
redX = {"x": 28, "y": 36}
whiteX = {"x": 44, "y": 36}
hero.setFlowerColor("red")
drawCircle(redX.x, redX.y, 10)
hero.setFlowerColor("white")
drawSquare(whiteX.x, whiteX.y, 10)
size = 10
hero.setFlowerColor("random")
hero.toggleFlowers(False)
cornerOffset = size / 2
hero.moveXY(59, 37)
hero.toggleFlowers(True)
x = 60
y = 26
angle = 0
while angle <= Math.PI * 2:
    newX = x + (size * Math.cos(angle))
    newY = y + (size * Math.sin(angle))
    hero.moveXY(newX, newY)
    hero.toggleFlowers(True)
    angle += 0.2
x = 60
y = 46
angle = 0
while angle <= Math.PI * 2:
    newX = x + (size * Math.cos(angle))
    newY = y + (size * Math.sin(angle))
    hero.moveXY(newX, newY)
    hero.toggleFlowers(True)
    angle += 0.2`
            },
            {
                id: 24,
                name: "康乃馨的力量",
                code: `twoPi = 2 * Math.PI
def degreesToRadians(degrees):
    return (degrees / 360) * twoPi
def drawPolyStars(center, radius, sides, skips, startAngle):
    angle = startAngle
    x = center.x
    y = center.y
    hero.toggleFlowers(False)
    loops = skips + 1
    stepAngle = loops * (twoPi / sides)
    if skips != 0 and (sides % loops) == 0:
        loops = skips
    endAngle = (twoPi * loops) + startAngle
    while angle <= endAngle:
        newX = x + radius * Math.cos(angle)
        newY = y + radius * Math.sin(angle)
        hero.moveXY(newX, newY)
        hero.toggleFlowers(True)
        angle += stepAngle
def drawStar(center, radius, sides, skips, startAngle):
    skipsPlusOne = skips + 1
    if ((sides / skipsPlusOne) != 1 and (sides % skipsPlusOne) == 0):
        for index in range(skipsPlusOne):
            angle = startAngle + index * (twoPi / sides)
            drawPolyStars(center, radius, sides, skips, angle)
    else:
        drawPolyStars(center, radius, sides, skips, startAngle)
def drawPolygon(center, radius, sides, startAngle):
    drawPolyStars(center, radius, sides, 0, startAngle)
def drawSpokes(center, radius, sides, startAngle):
    x = center.x
    y = center.y
    endAngle = twoPi + startAngle
    stepAngle = twoPi / sides
    angle = startAngle
    while angle < endAngle:
        newX = x + radius * Math.cos(angle)
        newY = y + radius * Math.sin(angle)
        if int(hero.pos.x) == int(x) and int(hero.pos.y) == int(y):
            hero.toggleFlowers(True)
            hero.moveXY(newX, newY)
        else:
            hero.toggleFlowers(False)
            hero.moveXY(newX, newY)
            hero.toggleFlowers(True)
            hero.moveXY(x, y)
        hero.toggleFlowers(False)
        angle += stepAngle
def ternary(thisOne, condition, thatOne):
    if condition:
        return thisOne
    else:
        return thatOne
def drawSpiral(center, size, loopNum, startAngle):
    x = center.x
    y = center.y
    hero.toggleFlowers(False)
    hero.moveXY(x, y)
    hero.toggleFlowers(True)
    steps = size * 2
    direction = Math.sign(loopNum)
    stepAngle = twoPi / steps / direction
    loops = direction * loopNum
    stepSize = size / steps / loops
    curSize = 0
    angle = startAngle
    endAngle = (twoPi * loopNum) + startAngle
    while ternary((angle >= endAngle), (loopNum < 0), (angle <= endAngle)):
        newX = x + curSize * Math.cos(angle)
        newY = y + curSize * Math.sin(angle)
        hero.moveXY(newX, newY)
        angle += stepAngle
        curSize += stepSize
    newX = x + size * Math.cos(endAngle)
    newY = y + size * Math.sin(endAngle)
    hero.moveXY(newX, newY)
redX = {"x": 28, "y": 36}
whiteX = {"x": 60, "y": 36}
whiteX2 = {'x': 60, 'y': 42}
drawPolygon(redX, 10, 6, degreesToRadians(90))
drawSpokes(redX, 10, 3, degreesToRadians(30))
drawStar(whiteX, 6, 7, 3, degreesToRadians(90))
drawSpiral(whiteX2, 15, 1, 3 * Math.PI / 2)
drawSpiral(whiteX2, 15, -1, 3 * Math.PI / 2)`
            },
            {
                id: 25,
                name: "山花林",
                code: `def yuan(center,size,loops):
    angle=0
    hero.toggleFlowers(False)
    hero.moveXY(center.x+size,center.y)
    hero.toggleFlowers(True)
    while angle<=2*Math.PI*loops:
        x=center.x+size*Math.cos(angle)
        y=center.y+size*Math.sin(angle)
        hero.moveXY(x,y)
        angle+=0.2
center={'x':85,'y':70}
yuan(center,35,4)`
            },
            {
                id: 26,
                name: "雾岛矿",
                code: `def findBestItem(friend, excludedItems):
    items = friend.findItems()
    bestItem = None
    bestItemValue = 0
    for item in items:
        if item not in excludedItems:
            if bestItemValue < item.value / friend.distanceTo(item):
                bestItemValue = item.value / friend.distanceTo(item)
                bestItem = item
    return bestItem
while True:
    peasants = hero.findByType("peasant")
    claimedItems = []
    for peasant in peasants:
        enemy = peasant.findNearestEnemy()
        if enemy:
            if hero.gold > hero.costOf('decoy'):
                hero.command(peasant, 'buildXY', 'decoy', peasant.pos.x, peasant.pos.y)
                continue
            pass
        item = findBestItem(peasant, claimedItems)
        if item:
            claimedItems.append(item)
            hero.command(peasant, 'move', item.pos)`
            },
            {
                id: 27,
                name: "猎手和猎物",
                code: `def pickUpCoin():
    items = hero.findItems()
    nearestCoin = hero.findNearest(items)
    if nearestCoin:
        hero.move(nearestCoin.pos)
def summonTroops():
    if hero.gold > hero.costOf("soldier"):
        hero.summon("soldier")
def commandSoldier(soldier):
    enemy = soldier.findNearestEnemy()
    if enemy:
        hero.command(soldier, "attack", enemy)
def commandArcher(soldier):
    enemy = soldier.findNearestEnemy()
    if enemy and soldier.distanceTo(enemy) < 25:
        hero.command(soldier, "attack", enemy)
while True:
    pickUpCoin()
    summonTroops()
    friends = hero.findFriends()
    for friend in friends:
        if friend.health < 100 and (friend.type == "soldier"):
            hero.command(friend, "defend", hero.pos)
        elif friend.type == "soldier":
            commandSoldier(friend)
        elif friend.type == "archer":
            commandArcher(friend)`
            },
            {
                id: 28,
                name: "讨厌的牦牛",
                code: `def removeByType(enemies, excludedType):
    tempList = []
    for enemy in enemies:
        if enemy.type != excludedType:
            tempList.append(enemy)
        pass
    return tempList
while True:
    enemies = hero.findEnemies()
    enemies = removeByType(enemies, "sand-yak")
    enemy = hero.findNearest(enemies)
    if enemy:
        hero.attack(enemy)`
            },
            {
                id: 29,
                name: "图书馆谋士",
                code: `def commandSoldier(soldier, soldierIndex, numSoldiers):
    angle = Math.PI * 2 * soldierIndex / numSoldiers
    defendPos = {"x": 41, "y": 40}
    defendPos.x += 10 * Math.cos(angle)
    defendPos.y += 10 * Math.sin(angle)
    hero.command(soldier, "defend", defendPos);
def findStrongestTarget():
    mostHealth = 0
    bestTarget = None
    enemies = hero.findEnemies()
    for enemy in enemies:
        if enemy.health>mostHealth:
            mostHealth=enemy.health
            bestTarget=enemy
    if bestTarget and bestTarget.health > 15:
        return bestTarget
    else:
        return None
def commandArcher(archer):
    nearest = archer.findNearestEnemy()
    if archerTarget:
        hero.command(archer, "attack", archerTarget)
    elif nearest:
        hero.command(archer, "attack", nearest)
archerTarget = None
while True:
    if not archerTarget or archerTarget.health <= 0:
        archerTarget = findStrongestTarget()
    friends = hero.findFriends()
    soldiers = hero.findByType("soldier")
    archers=hero.findByType("archer")
    for i in range(len(soldiers)):
        soldier = soldiers[i]
        commandSoldier(soldier, i, len(soldiers));
    for archer in archers:
        commandArcher(archer)`
            },
            {
                id: 30,
                name: "不安的休战",
                code: `def findSouthernUnits(units):
    southernUnits = []
    for unit in units:
        if unit.pos.y < hero.pos.y:
            southernUnits.append(unit)
    return southernUnits
while True:
    friends = hero.findFriends()
    enemies = hero.findEnemies()
    ogres = findSouthernUnits(enemies)
    if(len(ogres)>len(friends)):
        hero.summon("soldier")`
            },
            {
                id: 31,
                name: "分诊",
                code: `doctor = hero.findByType("paladin")[0]
mage = hero.findByType("pixie")[0]
helper = hero.findByType("peasant")[0]
soldiers = hero.findByType("soldier")
doctorPatients = []
magePatients = []
helperPatients = []
for soldier in soldiers:
    if soldier.maxSpeed < 6:
        magePatients.append(soldier)
    elif(soldier.maxHealth/2>soldier.health):
        doctorPatients.append(soldier)
    else:
        helperPatients.append(soldier)
mage["patients"] = magePatients
doctor["patients"] = doctorPatients
helper["patients"] = helperPatients`
            },
            {
                id: 32,
                name: "我们中间的间谍",
                code: `def numberInArray(array, number):
    for i in range(len(array)):
        if array[i] == numb:
            return True
    return False
def letterInWord(word, letter):
    for x in range(0, len(word), 1):
        item = word.substr(x, 1)
        if item == letter:
            return True
    return False
mineDistance = 5
spyLetter = "z"
friends = hero.findFriends()
for j in range(len(friends)):
    friendName = friends[j].id
    if letterInWord(friendName, spyLetter):
        hero.say(friendName + " is a spy!")
    else:
        hero.say(friendName + " is a friend.")`
            },
            {
                id: 33,
                name: "以我的名义",
                code: `def letterIndex(word, letter):
    for index in range(0, len(word), 1):
        if (word[index] == letter):
            return index
    return 0
ogreLetter = "z"
shaman = hero.findByType("thoktar")[0]
chestIndex = letterIndex(shaman.id, "z")
hero.moveXY(16 + chestIndex * 8, 36)`
            },
            {
                id: 34,
                name: "战争回响",
                code: `def isLetterInWord(word, letter):
    for index in range(len(word)):
        if word[index] == letter:
            return True
    return False
engineer = hero.findFriends()[0]
safeLetter = engineer.safeLetter
enemies = hero.findEnemies()
for index in range(len(enemies)):
    enemy = enemies[index]
    if isLetterInWord(enemy.id, safeLetter):
        while enemy.health > 0:
            hero.attack(enemy)`
            },
            {
                id: 35,
                name: "冰猎人",
                code: `def isSubstring(word, substring):
    rightEdge = len(word) - len(substring)
    for i in range(rightEdge + 1):
        for j in range(len(substring)):
            shiftedIndex = i + j
            if word[shiftedIndex] != substring[j]:
                break
            if j == len(substring) - 1:
                return True
    return False
enemies = hero.findEnemies()
for e  in range(len(enemies)):
    enemy = enemies[e]
    if(isSubstring(enemy.id, 'bos')):
        while enemy.health>0:
            hero.attack(enemy)`
            },
            {
                id: 36,
                name: "西北",
                code: `def wordInText(text, word):
    for i in range(len(text) - len(word)):
        for j in range(len(word)):
            shiftedIndex = i + j
            if text[shiftedIndex] != word[j]:
                break
            if shiftedIndex == len(text) - len(word) - 1:
                return True
    return False
def onHear(event):
    if wordInText(event.message, "west"):
        pet.moveXY(pet.pos.x - 28, pet.pos.y)
    elif wordInText(event.message, "north"):
        pet.moveXY(pet.pos.x, pet.pos.y + 24)
    else:
        potion = pet.findNearestByType("potion")
        if potion:
            pet.fetch(potion)
pet.on("hear", onHear)`
            },
            {
                id: 37,
                name: "高原者",
                code: `highlanderName = "mac"
def wordInString(string, word):
    lenString = len(string)
    lenWord = len(word)
    for index in range(0, (lenString - lenWord), 1):
        world = string.substr(index, lenWord)
        if (world == highlanderName):
            return True
    return False
soldiers = hero.findFriends()
for soldier in soldiers:
    if wordInString(soldier.id, highlanderName):
        hero.say(soldier.id + " be ready.")
hero.say("attack")`
            },
            {
                id: 38,
                name: "逃离雪人",
                code: `def startsWith(phrase, word):
    if len(word) > len(phrase):
        return False
    for index in range(0, len(word)):
        if word[index]!=phrase[index]:
            return False
    return True
guides = hero.findFriends()
for gIndex in range(len(guides)):
    guide = guides[gIndex]
    if startsWith(guide.id, "Mac"):
        while True:
            hero.move(guide.pos)`
            },
            {
                id: 39,
                name: "杂乱的走廊",
                code: `def onHear(event):
    word = event.message
    word = word.toLowerCase()
    if word == "north":
        pet.moveXY(pet.pos.x, pet.pos.y + 16)
    elif word == "east":
        pet.moveXY(pet.pos.x + 12, pet.pos.y)
    elif word == "south":
        pet.moveXY(pet.pos.x, pet.pos.y - 16)
    elif word == "west":
        pet.moveXY(pet.pos.x - 12, pet.pos.y)
pet.on('hear', onHear)`
            },
            {
                id: 40,
                name: "吵闹 宁静",
                code: `def onHear(event):
    words = event.message.split(" ")
    volume = words[0]
    password = words[1]
    if volume == "Loud":
        pet.say(words[1].toUpperCase())
    if volume == "Quiet":
        pet.say(words[1].toLowerCase())
    pet.moveXY(pet.pos.x+ 24, pet.pos.y)
def passDoor():
    guard = hero.findNearest(hero.findFriends())
    password = guard.password
    if guard.isLoud:
        hero.say(password.toUpperCase())
        pass
    elif guard.isQuiet:
        hero.say(password.toLowerCase())
        pass
    hero.moveXY(hero.pos.x+ 24, hero.pos.y)
pet.on("hear", onHear)
hero.moveXY(10, 14)
passDoor()
passDoor()`
            },
            {
                id: 41,
                name: "模拟侵略",
                code: `def startsWith(text, word):
    if len(word) > len(text):
        return False
    for index in range(len(word)):
        if word[index] != text[index]:
            return False
    return True
ogreNameStart = "Zog"
while True:
    enemy = hero.findNearestEnemy()
    suspect = hero.findNearest(hero.findFriends())
    if startsWith(suspect.id, ogreNameStart):
        hero.attack(suspect)
    elif enemy:
        hero.attack(enemy)
    else:
        hero.moveXY(27, 27)`
            },
            {
                id: 42,
                name: "资源谷",
                code: `def commandPeasant(peasant, coins):
    item = peasant.findNearest(coins)
    if item:
        hero.command(peasant, "move", item.pos)
friends = hero.findFriends()
peasants = {
    "Aurum": friends[0],
    "Argentum": friends[1],
    "Cuprum": friends[2]
}
while True:
    items = hero.findItems()
    goldCoins = []
    silverCoins = []
    bronzeCoins = []
    for i in range(len(items)):
        item = items[i]
        if item.value == 3:
            goldCoins.push(item)
        elif item.value == 2:
            silverCoins.push(item)
        else:
            bronzeCoins.push(item)
    commandPeasant(peasants.Aurum, goldCoins)
    commandPeasant(peasants.Argentum, silverCoins)
    commandPeasant(peasants.Cuprum, bronzeCoins)`
            },
            {
                id: 43,
                name: "播种火苗",
                code: `def chooseStrategy():
    enemies = hero.findEnemies()
    if len(enemies) > 20:
        return "retreat"
    if len(enemies) > 0:
        return "attack"
    if len(self.built) % 9 == 0:
        return "start-next-trap-column"
    else:
        return "build-next-trap-in-column"
trapsInColumn = 9
startX = 40
columnX = startX
def buildNextTrapInColumn(columnX, numTraps):
    newY = 7 * (numTraps % 9) + 10
    if hero.pos.y < newY:
        hero.move({"x": columnX - 5, "y": newY})
    else:
        buildTrap(columnX, newY)
def startNextTrapColumn(columnX, numTraps):
    newX = startX - (Math.floor(numTraps / trapsInColumn) * 6)
    if hero.pos.y > 10:
        hero.move({"x": newX - 5, "y": 10})
        return columnX
    else:
        buildTrap(newX, 10)
        return newX
def buildTrap(x, y):
    hero.buildXY("fire-trap", x, y)
def commandAttack():
    for friend in hero.findFriends():
        enemy = friend.findNearestEnemy()
        if enemy:
            hero.command(friend, 'attack', enemy)
    pass
def commandRetreat():
    hero.say("Retreat!")
    hero.moveXY(4, 42)
    for friend in hero.findFriends():
        hero.command(friend, 'move', Vector(24, friend.pos.y))
while True:
    strategy = chooseStrategy()
    if strategy == "attack":
        commandAttack()
    elif strategy == "build-next-trap-in-column":
        buildNextTrapInColumn(columnX, len(hero.built))
    elif strategy == "start-next-trap-column":
        columnX = startNextTrapColumn(columnX, len(hero.built))
    elif strategy == "retreat":
        commandRetreat()`
            },
            {
                id: 44,
                name: "FizzBuzz的路",
                code: `steps = 1
while True:
    if steps % 3 == 0 and steps % 5 != 0:
        hero.moveXY(hero.pos.x + 10, hero.pos.y)
    elif steps % 3 != 0 and steps % 5 == 0:
        hero.moveXY(hero.pos.x - 10, hero.pos.y)
    elif steps % 3 == 0 and steps % 5 == 0:
        hero.moveXY(hero.pos.x - 10, hero.pos.y + 10)
    else:
        hero.moveXY(hero.pos.x, hero.pos.y + 10)
    steps += 1`
            },
            {
                id: 45,
                name: "钢爪的间隙",
                code: `defendPoints = [{"x": 35, "y": 63}, {"x": 61, "y": 63}, {"x": 32, "y": 26}, {"x": 64, "y": 26}]
summonTypes = ["soldier", "soldier", "soldier", "soldier", "archer", "archer", "archer", "archer"]
def summonTroops():
    type = summonTypes[len(hero.built) % len(summonTypes)]
    if hero.gold >= hero.costOf(type):
        hero.summon(type)
def commandTroops():
    friends = hero.findFriends()
    for friendIndex, friend in enumerate(friends):
        hero.command(friend, 'defend', defendPoints[friendIndex % len(defendPoints)])
        pass
while True:
    summonTroops()
    commandTroops()`
            },
            {
                id: 46,
                name: "联合作战",
                code: `summonTypes = ['archer', 'archer', 'archer', 'archer', 'archer', 'archer', 'soldier']
def moveTo(position, fast=True):
    if (hero.isReady("jump") and hero.distanceTo > 10 and fast):
        hero.jumpTo(position)
    else:
        hero.move(position)
def pickUpNearestItem():
    items = hero.findItems()
    nearestItem = hero.findNearest(items)
    if nearestItem:
        moveTo(nearestItem.pos)
def summonTroops():
    type = summonTypes[len(hero.built) % len(summonTypes)]
    if hero.gold > hero.costOf(type):
        hero.summon(type)
def commandSoldiers():
    for soldier in hero.findFriends():
        enemy = hero.findNearestEnemy()
        if enemy and (soldier.type == 'archer' or soldier.type == 'soldier'):
            hero.command(soldier, "attack", enemy)
def attack(target):
    if target:
        if (hero.distanceTo(target) > 10):
            moveTo(target.pos)
        elif (hero.isReady("bash")):
            hero.bash(target)
        elif (hero.isReady("attack")):
            hero.attack(target)
        else:
            hero.shield()
while True:
    summonTroops()
    commandSoldiers()
    enemy = hero.findNearestEnemy()
    if (enemy and hero.distanceTo(enemy) < 10):
        attack(enemy)
    else:
        pickUpNearestItem()`
            },
            {
                id: 47,
                name: "零和",
                code: `while True:
    items = hero.findItems()
    item = hero.findNearest(items)
    enemies = hero.findEnemies()
    enemy = hero.findNearest(enemies)
    if (hero.health < hero.maxHealth / 3 and item and hero.distanceTo(item) < 50):
        item = hero.findNearestItem()
        if (item and hero.distanceTo(item) < 30):
            if (hero.isReady("jump")):
                hero.jumpTo(item.pos)
            else:
                hero.move(item.pos)
    elif (enemy):
        if (hero.isReady("jump") and hero.distanceTo > 10):
            hero.jumpTo(enemy.pos)
        elif (hero.isReady("bash")):
            hero.bash(enemy)
        elif (hero.isReady("power-up")):
            hero.powerUp()
            hero.attack(enemy)
        elif (hero.isReady("cleave")):
            hero.cleave(enemy)
        else:
            hero.attack(enemy)
    if hero.gold > hero.costOf("soldier"):
        hero.summon("soldier")
    if enemy:
        soldiers = hero.findFriends()
        soldierIndex = 0
        while (soldierIndex < len(soldiers)):
            soldier = soldiers[soldierIndex]
            hero.command(soldier, "attack", enemy)
            soldierIndex += 1`
            },
            {
                id: 48,
                name: "收割火焰",
                code: `def moveTo(position, fast=True):
    if (hero.isReady("jump") and hero.distanceTo > 10 and fast):
        hero.jumpTo(position)
    else:
        hero.move(position)
def chooseStrategy():
    enemies = hero.findEnemies()
    if hero.gold > hero.costOf("griffin-rider"):
        hero.summon("griffin-rider")
    fangrider = hero.findByType("fangrider")
    if (len(fangrider) > 0 and fangrider[0].pos.x < 38):
        return "fight-back"
    else:
        return "collect-coins"
def commandAttack():
    pass
def pickUpCoin():
    nearestItem = hero.findNearestItem()
    if nearestItem:
        moveTo(nearestItem.pos)
def heroAttack():
    target = hero.findNearest(hero.findByType("fangrider"))
    if target:
        if (hero.distanceTo(target) < 20):
            moveTo(target.pos)
        elif (hero.isReady("bash")):
            hero.bash(target)
        elif (hero.isReady("power-up")):
            hero.powerUp()
            hero.attack(target)
        elif (hero.isReady("cleave")):
            hero.cleave(target)
        else:
            hero.attack(target)
def commandTroops():
    for soldier in hero.findFriends():
        enemy = soldier.findNearestEnemy()
        if enemy:
            hero.command(soldier, "attack", enemy)
while True:
    commandAttack()
    commandTroops()
    strategy = chooseStrategy()
    if (strategy == "fight-back"):
        heroAttack()
    else:
        pickUpCoin()`
            },
            {
                id: 49,
                name: "三步密码",
                code: `hero.moveXY(52, 50)
friend = hero.findNearest(hero.findFriends())
message = friend.message
hero.moveXY(66, 34)
friend = hero.findNearest(hero.findFriends())
separator = friend.separator
hero.moveXY(52, 18)
friend = hero.findNearest(hero.findFriends())
index = friend.index;
hero.moveXY(44, 34)
messages = message.split(separator)
password = messages[index]
hero.say(password)
while True:
    enemy = hero.findNearestEnemy()
    if enemy:
        hero.attack(enemy)`
            },
            {
                id: 50,
                name: "方便敌方",
                code: `for x in range(8, 73, 16):
    hero.moveXY(x, 22)
    peasant = hero.findNearest(hero.findFriends())
    message = peasant.message
    if message:
        words = message.split(" ")
        last = words[len(words)-1]
        hero.summon(last)
for i in range(len(hero.built)):
    unit = hero.built[i]
    hero.command(unit, 'defend', unit.pos)
while True:
    enemy = hero.findNearestEnemy()
    if enemy:
        hero.attack(enemy)`
            },
            {
                id: 51,
                name: "医学院",
                code: `def startsWith(phrase, word):
    if len(word) > len(phrase):
        return False
    for index in range(len(word)):
        if word[index] != phrase[index]:
            return False
    return True
def onHear(event):
    if startsWith(event.speaker.id, "Exp"):
        potion = pet.findNearestByType("potion")
        if potion:
            pet.fetch(potion)
            pet.moveXY(28, 34)
pet.on("hear", onHear)
while True:
    mushrooms = hero.findByType("mushroom")
    nearest = hero.findNearest(mushrooms)
    if nearest and hero.health>700:
        hero.moveXY(nearest.pos.x, nearest.pos.y)`
            },
            {
                id: 52,
                name: "阅读噪声",
                code: `while True:
    enemy = hero.findNearestEnemy()
    if enemy and enemy.type == 'brawler':
        hero.say(enemy.id.toUpperCase())
    elif enemy:
        hero.attack(enemy)
    pass`
            },
            {
                id: 53,
                name: "理性防御",
                code: `def hideUnits(units):
    for i in range(len(units)):
        unit = units[i]
        hero.command(unit, "move", {'x': 34, 'y': 10 + i * 12})
peasants = hero.findFriends()
buildOrder = peasants[0].buildOrder
separator = ","
types = buildOrder.split(',')
for index in range(len(peasants)):
    peasant = peasants[index]
    x = 16
    y = 10 + index * 12
    buildType = types[index]
    hero.command(peasant, 'buildXY', buildType, x, y)
while True:
    enemy = hero.findNearestEnemy()
    if enemy:
        hideUnits(peasants)
        break
while True:
    enemy = hero.findNearestEnemy()
    if enemy:
        hero.attack(enemy)`
            },
            {
                id: 54,
                name: "提前思考",
                code: `def findNearestPair(units):
    minDistance = 9001
    nearestPair = ["Nobody", "Nobody"]
    for i in range(0, len(units)):
        for j in range(i + 1, len(units)):
            distance = units[i].distanceTo(units[j])
            if distance < minDistance:
                minDistance = distance
                nearestPair = [units[i].id, units[j].id]
    return nearestPair
while True:
    soldiers = hero.findByType("soldier")
    if hero.now() % 8 == 5:
        pairOfNames = findNearestPair(soldiers)
        hero.say(pairOfNames[0] + " " + pairOfNames[1])`
            },
            {
                id: 55,
                name: "无暇的宝石对",
                code: `def findValuePair(items):
    for i in range(len(items) - 1):
        for j in range(i + 1, len(items)):
            if items[i].value == items[j].value:
                return [items[i], items[j]]
    return None
while True:
    gems = hero.findItems()
    gemPair = findValuePair(gems)
    if gemPair:
        hero.moveXY(gemPair[0].pos.x, gemPair[0].pos.y)
        hero.moveXY(40, 44)
        hero.moveXY(gemPair[1].pos.x, gemPair[1].pos.y)
        hero.moveXY(40, 44)`
            },
            {
                id: 56,
                name: "驯鹿苏醒",
                code: `deerStatus = ['asleep', 'asleep', 'asleep', 'asleep', 'asleep']
friends = hero.findFriends()
for deerIndex in range(len(friends)):
    reindeer = friends[deerIndex]
    if reindeer.pos.y > 30:
        deerStatus[deerIndex] = 'awake'
    pass
for statusIndex in range(len(deerStatus)):
    reindeer = friends[deerIndex]
    hero.say('Reindeer ' + statusIndex + ' is ' + deerStatus[statusIndex])
    pass`
            },
            {
                id: 57,
                name: "孪生力量",
                code: `def areTwins(unit1, unit2):
    name1 = unit1.id
    name2 = unit2.id
    if name1.length != name2.length:
        return False
    for i in range(name1.length - 1):
        if name1[i] != name2[i]:
            return False
    return True
for paladin1 in hero.findFriends():
    for paladin2 in hero.findFriends():
        if (paladin1.id != paladin2.id and areTwins(paladin1, paladin2)):
            hero.say(paladin1.id + " " + paladin2.id)
hero.wait(5)
hero.moveXY(63, 38)
hero.moveXY(16, 38)`
            },
            {
                id: 58,
                name: "驯鹿观察者",
                code: `penPositions = [{'x': 20, 'y': 24}, {'x': 28, 'y': 24}, {'x': 36, 'y': 24}, {'x': 44, 'y': 24}, {'x': 52, 'y': 24}]
penOccupants = ['empty', 'empty', 'empty', 'empty', 'empty']
friends = hero.findFriends()
for deerIndex in range(len(friends)):
    reindeer = friends[deerIndex]
    for penIndex in range(len(penPositions)):
        penPos = penPositions[penIndex]
        if penPos.x == reindeer.pos.x and penPos.y == reindeer.pos.y:
            penOccupants[penIndex] = reindeer.id
            break;
            pass
for occIndex in range(len(penOccupants)):
    hero.say("Pen " + occIndex + " is " + penOccupants[occIndex])
    pass`
            },
            {
                id: 59,
                name: "大炮陆战队",
                code: `landingMap = hero.findNearest(hero.findFriends()).landingMap
cell = landingMap[0][0]
hero.say("row 0 column 0 " + cell)
hero.say("row 3 column 2 " + landingMap[3][2])
hero.say("row 2 column 1 " + landingMap[2][1])
hero.say("row 1 column 0 " + landingMap[1][0])
hero.say("row 0 column 2 " + landingMap[0][2])
hero.say("row 1 column 3 " + landingMap[1][3])`
            },
            {
                id: 60,
                name: "驯鹿招标",
                code: `penPositions = [{"x": 20, "y": 24}, {"x": 28, "y": 24}, {"x": 36, "y": 24}, {"x": 44, "y": 24}, {"x": 52, "y": 24}]
assignments = [None, None, None, None, None, ]
friends = hero.findFriends()
for deerIndex in range(len(friends)):
    reindeer = friends[deerIndex]
    for posIndex in range(len(penPositions)):
        penPos = penPositions[posIndex]
        if penPos.x == reindeer.pos.x and penPos.y == reindeer.pos.y:
            assignments[posIndex] = penPositions[posIndex]
            friends[deerIndex] = None
            break
            pass
for deerIndex in range(len(friends)):
    if not friends[deerIndex]:
        continue
    reindeer = friends[deerIndex]
    for posIndex in range(len(penPositions)):
        if not assignments[posIndex]:
            assignments[posIndex] = friends[deerIndex]
            hero.command(assignments[posIndex], 'move', penPositions[posIndex])
            break
            pass`
            },
            {
                id: 61,
                name: "力量的源点",
                code: `spell = "VENI"
wizard = hero.findNearest(hero.findFriends())
powerMap = wizard.powerMap
def convert(row, col):
    return {'x': 16 + col * 12, 'y': 16 + row * 12}
for i in range(len(powerMap)):
    for j in range(len(powerMap[i])):
        pointValue = powerMap[i][j]
        if (pointValue > 0):
            coor = convert(i, j)
            hero.moveXY(coor.x, coor.y)
            hero.say("VENI")
            enemy = hero.findNearestEnemy()
            if (enemy):
                while enemy.health > 0:
                    hero.attack(enemy)
            item = hero.findNearestItem()
            if (item):
                hero.moveXY(item.pos.x, item.pos.y)`
            },
            {
                id: 62,
                name: "危险谷",
                code: `for i in range(len(hero.grid)):
    row = hero.grid[i]
    for j in range(len(row)):
        if (row[j] == 1):
            hero.buildXY('fire-trap', 36 + j * 5, 20 + i * 6)
hero.moveXY(20, 42)
hero.moveXY(29, 66)`
            },
            {
                id: 63,
                name: "梦游者",
                code: `hunter = hero.findNearest(hero.findFriends())
fenceMap = hunter.getMap()
def convertCoor(row, col):
    return {'x': 34 + col * 4, 'y': 26 + row * 4}
for ri, row in enumerate(fenceMap):
    for rx, col in enumerate(row):
        if (col == 1):
            coor = convertCoor(ri, rx)
            hero.buildXY('fence', coor.x, coor.y)
hero.moveXY(22, 15)`
            },
            {
                id: 64,
                name: "边缘防御",
                code: `for x in range(40, 81, 20):
    hero.moveXY(x, 60)
    hero.say("Here")
for y in range(40, 19, -20):
    hero.moveXY(80, y)
    hero.say("Here")
for x in range(60, 19, -20):
    hero.moveXY(x, 20)
    hero.say("Here")
for y in range(40, 61, 20):
    hero.moveXY(20, y)
    hero.say("Here")
hero.moveXY(50, 40)`
            },
            {
                id: 65,
                name: "危险的路线",
                code: `def buildNorthLine():
    for x in range(40, 113, 24):
        hero.buildXY("fire-trap", x, 114)
def buildEastLine():
    for y in range(110, 37, -18):
        hero.buildXY("fire-trap", 140, y)
    pass
def buildSouthLine():
    for x in range(132, 31, -20):
        hero.buildXY("fire-trap", x, 22)
def buildWestLine():
    for y in range(28, 109, 16):
        hero.buildXY("fire-trap", 20, y)
    pass
buildNorthLine();
buildEastLine();
buildSouthLine();
buildWestLine();
hero.moveXY(40, 94);`
            },
            {
                id: 66,
                name: "快速堡垒",
                code: `foreman = hero.findNearest(hero.findFriends())
workerNameList = foreman.workerList
for i in range(1, len(workerNameList), 3):
    hero.say(workerNameList[i] + " - tower")
for i in range(0, len(workerNameList), 3):
    hero.say(workerNameList[i] + " - tent")
for i in range(2, len(workerNameList), 3):
    hero.say(workerNameList[i] + " - fence")`
            },
            {
                id: 67,
                name: "退寻子组数",
                code: `def dynamicMaxSum (gems):
    cycles = 0
    maxStartIndex = 0
    maxEndIndex = 0
    maxEndHere = gems[0].value
    currentStartIndex = 0
    maxBest = 0
    for i in range(len(gems)):
        cycles += 1
        maxEndHere += gems[i].value
        if maxEndHere < 0:
            maxEndHere = 0
            currentStartIndex = i + 1
        if maxEndHere > maxBest:
            maxStartIndex = currentStartIndex
            maxEndIndex = i
            maxBest = maxEndHere
    hero.say("I's taken " + cycles + " cycles.")
    return [maxStartIndex, maxEndIndex]
def naiveMaxSum(gems):
    cycles = 0
    maxStartIndex = 0
    maxEndIndex = 0
    maxBest = 0
    for i in range(len(gems)):
        sum = 0
        for j in range(i, len(gems)):
            cycles += 1
            if cycles > 104:
                hero.say("I fed up of calculations.")
                return [i, j]
            sum += gems[j].value
            if sum > maxBest:
                maxStartIndex = i
                maxEndIndex = j
                maxBest = sum
    hero.say("I's taken " + cycles + " cycles.")
    return [maxStartIndex, maxEndIndex]
items = hero.findItems()
edges = dynamicMaxSum(items)
x1 = edges[0] * 4 + 4
x2 = edges[1] * 4 + 4
hero.moveXY(x1, 40)
hero.moveXY(x2, 40)
hero.moveXY(40,64)`
            },
            {
                id: 68,
                name: "网格搜索",
                code: `leftBorder = 20
rightBorder = 61
bottomBorder = 20
topBorder = 51
step = 10
for x in range(leftBorder, rightBorder, step):
    for y in range(leftBorder, rightBorder, step):
        hero.moveXY(x, y)
        hero.say('Djigurda')
hero.moveXY(20, 10)`
            },
            {
                id: 69,
                name: "拿起武器！",
                code: `sergeant = hero.findNearest(hero.findFriends())
stepX = sergeant.tentDistanceX
stepY = sergeant.tentDistanceY
tentsInRow = 5
tentsInColumn = 4
firstX = 10
firstY = 14
for y in range(firstY, stepY * tentsInColumn + stepY, stepY):
    for x in range(firstX, stepX * tentsInColumn + stepX, stepX):
        hero.moveXY(x, y)
        hero.say('alarm')`
            },
            {
                id: 70,
                name: "网格雷区",
                code: `for x in range(12, 12 + 8 * 6, 8):
    for y in range(12, 12 + 8 * 7, 8):
        hero.buildXY("fire-trap", x, y)
        pass
    hero.moveXY(hero.pos.x + 8, hero.pos.y)
while True:
    enemy = hero.findNearestEnemy()
    if enemy and hero.distanceTo(enemy) <= 20:
        hero.moveXY(x, y)`
            },
            {
                id: 71,
                name: "雪花莲",
                code: `forestMap = hero.findNearest(hero.findFriends()).forestMap
hero.say("Row " + 0 + " Column " + 1 + " Fire!")
cells = [{"row": 0, "col": 4}, {"row": 1, "col": 0}, {"row": 1, "col": 2}, {"row": 1, "col": 4},
         {"row": 2, "col": 1}, {"row": 2, "col": 3}, {"row": 2, "col": 5}, {"row": 3, "col": 0},
         {"row": 3, "col": 2}, {"row": 3, "col": 4}, {"row": 4, "col": 1}, {"row": 4, "col": 2},
         {"row": 4, "col": 3}, {"row": 5, "col": 0}, {"row": 5, "col": 3}, {"row": 5, "col": 5},
         {"row": 6, "col": 1}, {"row": 6, "col": 3}, {"row": 6, "col": 4}, {"row": 7, "col": 0}];
for cell in cells:
    row = cell["row"]
    col = cell["col"]
    if row < len(forestMap):
        if col < len(forestMap[row]):
            if forestMap[row][col] == 0:
                hero.say("Row " + row + " Column " + col + " Fire!")`
            },
            {
                id: 72,
                name: "劳心劳力",
                code: `def moveTo(position, fast=True):
    if (hero.isReady("jump") and hero.distanceTo > 10 and fast):
        hero.jumpTo(position)
    else:
        hero.move(position)
def attack(target):
    if target:
        if (hero.distanceTo(target) > 10):
            moveTo(target.pos)
        elif (hero.isReady("bash")):
            hero.bash(target)
        elif (hero.isReady("power-up")):
            hero.powerUp()
            hero.attack(target)
        elif (hero.isReady("cleave")):
            hero.cleave(target)
        else:
            hero.attack(target)
def chooseTarget(friend):
    if friend.type == "archer":
        if len(hero.findByType("thrower")) > 0:
            return friend.findNearest(hero.findByType("thrower"))
        elif len(hero.findByType("witch")) > 0:
            return friend.findNearest(hero.findByType("witch"))
        else:
            return friend.findNearest(hero.findEnemies())
    elif friend.type == "soldier":
        return friend.findNearest(hero.findByType("witch"))
while True:
    friends = hero.findFriends()
    for friend in friends:
        enemy = chooseTarget(friend)
        if (enemy):
            hero.command(friend, 'attack', enemy)
    attack(hero.findNearestEnemy())`
            },
            {
                id: 73,
                name: "推进",
                code: `while True:
    friends = hero.findFriends()
    projectiles = hero.findEnemyMissiles()
    for friend in friends:
        if friend.type is "paladin":
            projectile = friend.findNearest(projectiles)
            if projectile and friend.distanceTo(projectile) < 10:
                hero.command(friend, 'shield')
            else:
                x = friend.pos.x + 10
                y = friend.pos.y
                hero.command(friend, 'move', {'x': x, 'y': y})
            pass
        else:
            pass
        pass`
            },
            {
                id: 74,
                name: "云层围攻",
                code: `def moveTo(position, fast=True):
    if (hero.isReady("jump") and fast):
        hero.jumpTo(position)
    else:
        hero.move(position)
def pickUpNearestItem():
    items = hero.findItems()
    nearestItem = hero.findNearest(items)
    if nearestItem:
        moveTo(nearestItem.pos)
coors = [[67, 41], [24, 54], [69, 55], [25, 34], [69, 32]]
buildTypes = ['arrow-tower']
def buildTroops():
    coor = coors[len(hero.built) % len(coors)]
    type = buildTypes[len(hero.built) % len(buildTypes)]
    if hero.gold > hero.costOf(type):
        hero.buildXY(type, coor[0], coor[1])
while True:
    pickUpNearestItem()
    buildTroops()`
            },
            {
                id: 75,
                name: "黑暗中的突袭者",
                code: `arryn = hero.findByType("raider")[0]
peasant = hero.findByType("peasant")[0]
def chooseHeroStrategy():
    if peasant.pos.x - hero.pos.x > 15:
        return "advance"
    else:
        return "fight"
    pass
def heroFight():
    enemy=hero.findNearestEnemy()
    while enemy and hero.distanceTo(enemy) < 10 and enemy.health > 0:
        hero.attack(enemy)
    pass
def heroAdvance():
    hero.moveXY(peasant.pos.x-5,peasant.pos.y)
    pass
def choosePeasantStrategy():
    if hero.isPathClear(peasant.pos,{'x':peasant.pos.x,'y':50}):
        return "build-above"
    if hero.isPathClear(peasant.pos,{'x':peasant.pos.x,'y':25}):
        return "build-below"
    else:
        return "follow"
    pass
def peasantAdvance():
    hero.command(peasant,"move",{'x':arryn.pos.x-5,'y':arryn.pos.y})
    pass
def peasantBuild(x,y):
    hero.command(peasant,"buildXY","palisade",x,y)
    pass
while True:
    heroStrategy = chooseHeroStrategy()
    if heroStrategy == "fight":
        heroFight()
    elif heroStrategy == "advance":
        heroAdvance()
    peasantStrategy = choosePeasantStrategy()
    if peasantStrategy == "build-above":
        peasantBuild(peasant.pos.x, peasant.pos.y + 5)
    elif peasantStrategy == "build-below":
        peasantBuild(peasant.pos.x, peasant.pos.y - 5)
    elif peasantStrategy == "follow":
        peasantAdvance()`
            },
            {
                id: 76,
                name: "形状和性状",
                code: `def toTernary(number):
    string = ""
    while number != 0:
        remainder = number % 3
        number = (number - remainder) / 3
        string = remainder + string
    return string
def toBinary(number):
    string = ""
    while number != 0:
        remainder = number % 2
        number = (number - remainder) / 2
        string = remainder + string
    return string
while True:
    enemies = hero.findEnemies()
    dangerous = findMostDangerous(enemies)
    if dangerous:
        hero.say(toTernary(dangerous.health) + " " + toBinary(dangerous.type))
def findMostDangerous(enemies):
    mostDangerous = None
    mostHealth = 0
    for i in range(len(enemies)):
        enemy = enemies[i]
        if enemy.health > mostHealth:
            mostDangerous = enemy
            mostHealth = enemy.health
    return mostDangerous`
            },
            {
                id: 77,
                name: "匹配火线",
                code: `fieldMap = hero.findFriends()[0].getMap()
map = []
i = 0
j = 0
for i in range(0, len(fieldMap)):
    map.push([])
for i in range(0, len(fieldMap)):
    for j in range(0, len(fieldMap[0])):
        if (fieldMap[i][j] == "x"):
            map[i].push("x")
        else:
            map[i].push(".")
hero.say(map[0].length + " nn " + map.length)
def find(arr, i, j):
    array = []
    array.push([i, j])
    while (len(array) > 0):
        temp = []
        for x in range(0, len(array)):
            m = array[x][0]
            n = array[x][1]
            arr[m][n] = "."
            if (n + 1 < 27 and arr[m][n + 1] == "x"):
                temp.push([m, n + 1])
                if (m == 15 and n + 1 == 13):
                    hero.moveXY(j * 5 + 15, 40)
            if (m + 1 < 16 and arr[m + 1][n] == "x"):
                temp.push([m + 1, n]);
                if (m + 1 == 15 and n == 13):
                    hero.moveXY(j * 5 + 15, 40)
            if (n - 1 >= 0 and arr[m][n - 1] == "x"):
                temp.push([m, n - 1])
                if (m == 15 and n - 1 == 13):
                    hero.moveXY(j * 5 + 15, 40);
            if (m - 1 >= 0 and arr[m - 1][n] == "x"):
                temp.push([m - 1, n])
                if (m - 1 == 15 and n == 13):
                    hero.moveXY(j * 5 + 15, 40)
        array = []
        array = temp
for j in range(0, len(map[0])):
    if (map[0][j] == "x"):
        find(map, 0, j)`
            },
            {
                id: 78,
                name: "云层宝藏（选速度快的英雄）",
                code: `def onSpawn(event):
    while True:
        pet.moveXY(125,96)
        pet.moveXY(125,34)
        pet.moveXY(124,65)
def findBestItem(friend,excludedItems):
    items=hero.findItems()
    bestItem=None
    bestItemValue=0
    for item in items:
        if item in excludedItems:
            continue
        if item.value/friend.distanceTo(item) > bestItemValue:
            bestItemValue=item.value/friend.distanceTo(item)
            bestItem=item
    return bestItem
def summonSoldier():
    if hero.gold > hero.costOf("soldier") and hero.findNearestEnemy():
        hero.summon("soldier")
def commandSoldier():
    soldier=hero.findByType("soldier")
    for soldier in soldiers:
        enemy=soldier.findNearestEnemy()
        if enemy:
            hero.command(soldier,"attack",enemy)
        else:
            hero.command(soldier,"move",{'x':hero.pos.x-3,'y':hero.pos.y-3})
def heroAttack():
    ogr=hero.findNearestEnemy()
    if ogr and ogr.health > 0 and hero.distanceTo(ogr) < 15:
        if hero.isReady("bash"):
            hero.bash(ogr)
        elif hero.canCast("chain-lightning",ogr):
            hero.cast("chain-lightning",ogr)
        else:
            hero.attack(ogr)
pet.on("spawn",onSpawn)
while True:
    flag = hero.findFlag()
    if flag:
        hero.pickUpFlag(flag)
    peasants=hero.findByType("peasant")
    claimedItems=[]
    for peasant in peasants:
        enemy=peasant.findNearestEnemy()
        if enemy:
            if enemy.target==peasant and hero.gold > 25:
                continue
            pass
        item=findBestItem(peasant,claimedItems)
        if item and peasant.distanceTo(item) < 30:
            claimedItems.append(item)
            hero.command(peasant,"move",item.pos)
    summonSoldier()
    commandSoldier
    heroAttack()`
            },
            {
                id: 79,
                name: "致命的光盘",
                code: `targets = []
targets.append({ "x": hero.pos.x-5, "y": hero.pos.y})
targets.append({ "x": hero.pos.x, "y": hero.pos.y+5})
targets.append({ "x": hero.pos.x, "y": hero.pos.y-5})
while len(targets) > 0:
    if hero.isReady("throw"):
        target = targets.pop(0)
        hero.throwPos(target)
    else:
        hero.wait(0.01)`
            },
            {
                id: 80,
                name: "多少钱？",
                code: `fencePrice = 3
lawnPrice = 2
foreman = hero.findNearest(hero.findFriends())
corners = foreman.corners
bottomLeft = corners.bottomLeft
topRight = corners.topRight
width = topRight.x - bottomLeft.x
height = topRight.y - bottomLeft.y
perimeter = (width+height)*2
fenceCost = fencePrice * perimeter
area = width*height
lawnCost = area * lawnPrice
totalCost = fenceCost + lawnCost
hero.say("The total price is " + totalCost)
foreman.bill(totalCost)`
            },
            {
                id: 81,
                name: "矩形仪式",
                code: `def almostEqual(valueA, valueB):
    pass
    return valueA < valueB * 1.03 and valueA > valueB * 0.97
def perimeter(side1, side2):
    return (side1 + side2) * 2
def area(side1, side2):
    return side1 * side2
requiredPerimeter = 104
requiredArea = 660
base = hero.findNearest(hero.findFriends())
while True:
    sideSN = base.distanceTo("Femae")
    sideWE = base.distanceTo("Illumina")
    currentPerimeter = perimeter(sideSN, sideWE)
    currentArea = area(sideSN, sideWE)
    if almostEqual(currentArea, requiredArea) and almostEqual(currentPerimeter, requiredPerimeter):
        hero.say("VENITE!")
        break`
            },
            {
                id: 82,
                name: "易爆工程",
                code: `perimeter = 160
leftBottom = {"x": hero.pos.x, "y": hero.pos.y}
leftTop = hero.findHazards()[0].pos
height = hero.distanceTo(leftTop)
width = (perimeter - height*2)/2
hero.buildXY("fire-trap", leftBottom.x, leftBottom.y)
hero.buildXY("fire-trap", leftBottom.x+width, leftBottom.y)
hero.buildXY("fire-trap", leftBottom.x+width, leftTop.y)
hero.moveXY(74, 32)
area = width*height
hero.say(area)`
            },
            {
                id: 83,
                name: "火山战士",
                code: `def findMostLeft (units):
    if len(units) == 0:
        return None
    mostLeft = units[0]
    for unit in units:
        if unit.pos.x < mostLeft.pos.x:
            mostLeft = unit
    return mostLeft
def findMostBottom (units):
    if len(units) == 0:
        return None
    mostBottom = units[0]
    for unit in units:
        if unit.pos.y < mostBottom.pos.y:
            mostBottom = unit
    return mostBottom
paladins = hero.findByType("paladin")
ml = findMostLeft(paladins)
mb = findMostBottom(paladins)
x = ml.pos.x
y = mb.pos.y
hero.moveXY(x, y)
while True:
    hero.shield()`
            },
            {
                id: 84,
                name: "方盾",
                code: `def findByName(name, thangs):
    for i in range(len(thangs)):
        thang = thangs[i]
        if thang.id == name:
            return thang
    return None
friends = hero.findFriends()
celadia = findByName("Celadia", friends)
dedalia = findByName("Dedalia", friends)
sideLength = celadia.distanceTo(dedalia)
illumina = findByName("Illumina", friends)
vaelia = findByName("Vaelia", friends)
hero.command(illumina, 'move', {'x': celadia.pos.x, 'y': celadia.pos.y - sideLength})
hero.command(vaelia, 'move', {'x': dedalia.pos.x, 'y': dedalia.pos.y - sideLength})`
            },
            {
                id: 85,
                name: "森林公园",
                code: `gardener = hero.findNearest(hero.findFriends())
gardenWidth = gardener.gardenWidth
gardenHeight = gardener.gardenHeight
hero.toggleFlowers(True)
x = hero.pos.x
y = hero.pos.y
hero.moveXY(x+gardenWidth, y)
hero.moveXY(x+gardenWidth, y-gardenHeight)
hero.moveXY(x, y-gardenHeight)
hero.moveXY(x, y)`
            },
            {
                id: 86,
                name: "矩形形态",
                code: `step = 8
sergeant = hero.findNearest(hero.findByType("soldier"))
soldierX = 8
soldierY = 8
width = sergeant.rectWidth
height = sergeant.rectHeight
for x in range(soldierX, soldierX + width + 1, 8):
    for y in range(soldierY, soldierY + height + 1, 8):
        hero.summon("soldier")
        lastUnit = hero.built[len(hero.built)-1]
        hero.command(lastUnit, "move", {'x':x, 'y':y })
sniper = hero.findNearest(hero.findByType("archer"))
archerX1 = 48
archerY1 = 8
archerX2 = sniper.archerX2
archerY2 = sniper.archerY2
for x in range(archerX1, archerX2 + 1, 8):
    for y in range(archerY1, archerY2 + 1, 8):
        hero.summon("archer")
        lastUnit = hero.built[len(hero.built)-1]
        hero.command(lastUnit, "move", {'x':x, 'y':y })`
            },
			{
				id: 87,
				name: "人神",
				code: `def summonAndSend(type, x, y):
    hero.summon(type)
    unit = hero.built[len(hero.built)-1]
    hero.command(unit, "move", {"x": x, "y": y})
centerUnit = hero.findNearest(hero.findFriends())
center = centerUnit.pos
rectWidth = centerUnit.rectWidth
rectHeight = centerUnit.rectHeight
leftBottomX = center.x - rectWidth / 2
leftBottomY = center.y - rectHeight / 2
summonAndSend("soldier", leftBottomX, leftBottomY)
leftTopX = center.x - rectWidth / 2
leftTopY = center.y + rectHeight / 2
summonAndSend("archer", leftTopX, leftTopY)
rightTopX = center.x + rectWidth / 2
rightTopY = center.y + rectHeight / 2
summonAndSend("soldier", rightTopX, rightTopY)
rightBottomX = center.x + rectWidth / 2
rightBottomY = center.y - rectHeight / 2
summonAndSend("archer", rightBottomX, rightBottomY)
hero.moveXY(68, 58)`
			},
			{
				id: 88,
				name: "栅栏制造者",
				code: `customer = hero.findNearest(hero.findFriends())
x1 = customer.leftBottom.x
y1 = customer.leftBottom.y
x2 = customer.rightTop.x
y2 = customer.rightTop.y
step = 4
for x in range(x1 + step, x2 + 1, step):
    hero.buildXY("fence", x, y1)
for y in range(y1 + step, y2 + 1, step):
    hero.buildXY("fence", x2, y);
for x in range(x2 - step, x1 - 1, -step):
    hero.buildXY("fence", x, y2)
for y in range(y2 - step,y1 -1, -step):
    hero.buildXY("fence", x1, y);`
			},
			{
				id: 89,
				name: "园丁",
				code: `def growSquare(cx, cy, side):
    width = side/2
    hero.moveXY(cx-width, cy-width)
    hero.toggleFlowers(True)
    hero.moveXY(cx-width, cy+width)
    hero.moveXY(cx+width, cy+width)
    hero.moveXY(cx+width, cy-width)
    hero.moveXY(cx-width, cy-width)
    hero.toggleFlowers(False)
keeper = hero.findNearest(hero.findFriends())
points = keeper.pointsForWork
squareSize = 8
hero.toggleFlowers(False)
for pos in points:
    growSquare(pos.x, pos.y, squareSize)`
			},
			{
				id: 90,
				name: "笨拙的圆",
				code: `circleRadius = 20
def onCircle(unit, radius):
    distance = hero.distanceTo(unit)
    inaccuracy = 2
    minDistance = radius - inaccuracy
    maxDistance = radius + inaccuracy
    return distance <= maxDistance and distance >= minDistance
while True:
    soldiers = hero.findByType("soldier")
    for soldier in soldiers:
        if not(onCircle(soldier, circleRadius)):
            hero.say(soldier.id)
        pass`
			},
			{
				id: 91,
				name: "安全点",
				code: `def almostEqual(n1, n2):
    return abs(n1 - n2) <= 0.5
def allSameDistance(thangs):
    if len(thangs) == 0:
        return True
    etalon = hero.distanceTo(thangs[0])
    for thang in thangs:
        if not (almostEqual(hero.distanceTo(thang), etalon)):
            return False
    return True
bombs = hero.findEnemies()
for x in range(36, 45):
    for y in range(30, 39):
        hero.moveXY(x, y)
        if allSameDistance(bombs):
            hero.say("HEEEEEEEEEY!!!")
            hero.moveXY(40, 58)
hero.say("Heh. Nothing.");`
			},
			{
				id: 92,
				name: "开采宝石",
				code: `innerRadius = hero.distanceTo(hero.findNearestItem())
def definitelyGreater(a, b):
    return a > b + 0.5
centre = {"x": 40, "y": 34}
gems = hero.findItems()
for gem in gems:
    if definitelyGreater(hero.distanceTo(gem), innerRadius):
        hero.moveXY(gem.pos.x, gem.pos.y)
        hero.moveXY(centre.x, centre.y)`
			},
			{
				id: 93,
				name: "牦牛行径",
				code: `yak1 = hero.findNearestEnemy()
radius1 = hero.distanceTo(yak1)
circumference1 = 2 * Math.PI * radius1
hero.say(circumference1)
hero.moveXY(60, 34)
yak2 = hero.findNearestEnemy()
radius2 = hero.distanceTo(yak2)
circumference2 = 2 * Math.PI * radius2
hero.say(circumference2)`
			},
			{
				id: 94,
				name: "雪人面积",
				code: `chosen = hero.findFriends()[0]
radius = chosen.distanceTo(chosen.findNearestEnemy())
area = radius * radius * Math.PI
hero.say(area)
while True:
    enemyattack = hero.findNearestEnemy()
    if (enemyattack):
        hero.attack(enemyattack)`
			},
			{
				id: 95,
				name: "危险撬锁",
				code: `def almostEqual(a, b):
    return Math.abs(a - b) < (b * 0.05)
bomb = hero.findByType("robobomb")[0]
wizards = hero.findByType("wizard")
chargeArea = bomb.chargeArea
while True:
    radius = bomb.distanceTo(wizards[0])
    area = radius*radius*Math.PI
    if(almostEqual(chargeArea, area)):
        hero.say('Run, Forest, Run')`
			},
			{
				id: 96,
				name: "骨头舞蹈",
				code: `def almostEqual(a, b):
    return Math.abs(a - b) < 1
while True:
    skeleton = hero.findNearestEnemy()
    radius = hero.distanceTo(skeleton)
    length = 2*radius*Math.PI
    if almostEqual(length, 100):
        hero.say('CNM!')`
			},
			{
				id: 97,
				name: "分散的地牢",
				code: `def moveBothTo(point):
    while hero.distanceTo(point) > 1:
        hero.move(point)
        hero.command(peasant, "move", point)
peasant = hero.findNearest(hero.findFriends())
while True:
    hero.command(peasant, "buildXY", "decoy", peasant.pos.x + 2, peasant.pos.y)
    nextPoint = {"x": hero.pos.x, "y": hero.pos.y + 28};
    moveBothTo(nextPoint)
    nextPoint = {"x": hero.pos.x + 28, "y": hero.pos.y}
    enemy=hero.findNearestEnemy()
    while enemy:
        if enemy.health > 0:
            hero.attack(enemy)
        enemy=hero.findNearestEnemy()
    moveBothTo(nextPoint)`
			},
			{
				id: 98,
				name: "严峻的决心",
				code: `summonTypes = ['griffin-rider']
def summonTroops():
    type = summonTypes[len(hero.built) % len(summonTypes)]
    if hero.gold > hero.costOf(type):
        hero.summon(type)
def lowestHealthPaladin():
    lowestHealth = 99999
    lowestFriend = None
    friends = hero.findFriends()
    for friend in friends:
        if friend.type != "paladin":
            continue
        if friend.health < lowestHealth and friend.health < friend.maxHealth:
            lowestHealth = friend.health
            lowestFriend = friend
    return lowestFriend
def commandPaladin(paladin):
    if (paladin.canCast("heal")):
        target = lowestHealthPaladin()
        if target:
            hero.command(paladin, "cast", "heal", target)
    elif (paladin.health < 200):
        hero.command(paladin, "shield")
    else:
        target = paladin.findNearestEnemy()
        if (target):
            hero.command(paladin, "attack", target)
def commandPeasant(peasant):
    item = peasant.findNearestItem()
    if item:
        hero.command(peasant, 'move', item.pos)
def commandGriffin(griffin):
    target = hero.findNearest(hero.findByType('warlock'))
    if not target:
        target = griffin.findNearestEnemy()
    if (target):
        hero.command(griffin, "attack", target)
def commandFriends():
    friends = hero.findFriends()
    for friend in friends:
        if friend.type == "peasant":
            commandPeasant(friend)
        elif friend.type == "griffin-rider":
            commandGriffin(friend)
        elif friend.type == "paladin":
            commandPaladin(friend)
while True:
    commandFriends()
    summonTroops()`
			},
			{
				id: 99,
				name: "拓地",
				code: `def areAntipodes(unit1, unit2):
    reversed1 = ""
    for i in range(len(unit1.id) - 1, -1, -1):
        reversed1 += unit1.id[i]
    return reversed1 == unit2.id
friends = hero.findFriends()
enemies = hero.findEnemies()
for friend in friends:
    for enemy in enemies:
        if areAntipodes(friend, enemy):
            hero.command(friend, 'move', enemy.pos)
hero.wait(20)
enemies = hero.findEnemies()
while len(enemies) == 1:
    hero.attack(hero.findNearestEnemy())`
			},
			{
				id: 100,
				name: "雪人食人族",
				code: `wizard = hero.findNearest(hero.findFriends())
yetis = wizard.findEnemies()
index = len(yetis)-1
while index>=0:
    while yetis[index].health>0:
        hero.attack(yetis[index])
    index = index - 1`
			},
			{
				id: 101,
				name: "寻找开始",
				code: `def averageSize(burls):
    sum = sumSize(burls)
    return sum / burls.length
def sumSize(burls):
    sum = 0
    for burl in burls:
        sum = sum + burl.size
    return sum
while True:
    enemies = hero.findEnemies()
    hero.say(averageSize(enemies))`
			},
			{
				id: 102,
				name: "诱骗牦牛",
				code: `def averageSize(yaks):
    sum = 0
    for yak in yaks:
        sum+=yak.size
    return sum / yaks.length
yaks = hero.findEnemies()
avgSize = averageSize(yaks)
bestYak = None
closestDist = 9999
for i in range(len(yaks)):
    yak = yaks[i]
    yakDistance = hero.distanceTo(yak)
    yakSize = yak.size
    if yakSize > averageSize(yaks) and yakDistance < closestDist:
        closestDist=yakDistance
        bestYak=yak
hero.say(bestYak)`
			},
			{
				id: 103,
				name: "睡眠样本",
				code: `def average(array):
    sum = 0
    len = 0
    for yet in array:
        if yet.type == 'yeti':
            sum = sum + yet.size
            len = len + 1
    return sum / len
enemies = hero.findEnemies()
hero.say(average(enemies))`
			},
			{
				id: 104,
				name: "空虚数",
				code: `def moveNSteps(n):
    hero.moveXY(hero.pos.x + 8 * n, hero.pos.y)
riddle = hero.findNearestEnemy().riddle
trimmed = riddle.trim()
spot = len(riddle)-len(trimmed)
moveNSteps(spot)
hero.say("CNM")`
			},
			{
				id: 105,
				name: "特洛伊雪人",
				multiCode: true, // 标记为多代码块关卡
                codes: [
                    {
                        title: "  ",
                        code: `def findFriendByName(name):
    friends = hero.findFriends()
    for i in range(len(friends)):
        if friends[i].id == name:
            return friends[i]
    return None
sergeant = hero.findNearest(hero.findFriends())
wereList = sergeant.wereList
wereNames = wereList.split(",")
for i in range(len(wereNames)):
    trimed = wereNames[i].trim()
    friend=findFriendByName(trimed)
    if friend:
        hero.command(friend, 'move', {'x':48, 'y':48})`
                    },
                    {
                        title: "如果过不了请在代码最后添加以下代码",
                        code: `hero.moveXY(4,50)`
                    }
                ]
			},
			{
				id: 106,
				name: "双重间谍",
				code: `def passagePosByNum(n):
    return {"x": 60, "y": n * 12 + 8}
def onHear(event):
    message = event.message
    messages = message.trim(" ")
    number = len(message)-len(messages);
    pet.say(number)
    pos = passagePosByNum(number)
    pet.moveXY(pos.x, pos.y)
    pet.moveXY(0, pos.y)
pet.on("hear", onHear)
while True:
    hero.moveXY(pet.pos.x, pet.pos.y)`
			},
			{
				id: 107,
				name: "匿名银行",
				code: `message = hero.findNearest(hero.findFriends()).message
passwords = []
passwordLength = 5
words = message.split(";")
for word in words:
    wordt = word.trim()
    if len(wordt)==5:
        passwords.push(wordt)
marksPos = [{"x": 12, "y": 14}, {"x": 38, "y": 38},
            {"x": 42, "y": 16}, {"x": 54, "y": 12}];
for i in range(4):
    pos = marksPos[i]
    hero.moveXY(pos.x, pos.y)
    password = passwords[i]
    if password:
        hero.say(password)
    else:
        hero.say("qwerty")`
			},
			{
				id: 108,
				name: "食人魔幻象",
				code: `def findRealEnemy(enemies):
    for index in range(len(enemies)):
        enemy = enemies[index]
        lower = enemy.id.toLowerCase()
        words = lower.split(' ')
        second = words[1]
        if second[0] == second[len(second)-1]:
            return enemy
while True:
    ogres = hero.findEnemies()
    realOgre = findRealEnemy(ogres)
    if realOgre:
        while realOgre.health > 0:
            hero.attack(realOgre)`
			},
			{
				id: 109,
				name: "巅峰之门",
				code: `def attackSikll():
    enemy=hero.findNearestEnemy()
    if enemy and hero.distanceTo(enemy) < 10:
        if hero.isReady("bash"):
            hero.bash(enemy)
        elif hero.canCast("chain-lightning",enemy):
            hero.cast("chain-lightning",enemy)
        else:
            hero.attack(enemy)
def commandFriend(friend):
    enemy=hero.findNearestEnemy()
    if friend.type=="paladin":
        if friend.canCast("heal"):
            hero.command(friend,"cast","heal",hero)
        else:
            hero.command(friend,"shield")
            hero.command(friend,"move",{'x':hero.pos.x-10,'y':hero.pos.y})
    else:
        if enemy and enemy.health > 0 and friend.distanceTo(enemy) < 25:
            hero.command(friend,"attack",enemy)
        else:
            hero.command(friend,"move",{'x':hero.pos.x-13,'y':hero.pos.y-5})
def pickUpCoin():
    item=hero.findNearestItem()
    if item and hero.distanceTo(item) < 10:
        hero.move(item.pos)
def summontroop():
    if hero.gold > hero.costOf("griffin-rider"):
        hero.summon("griffin-rider")
while True:
    flag = hero.findFlag()
    if flag:
        hero.pickUpFlag(flag)
    pickUpCoin()
    summontroop()
    friends = hero.findFriends()
    for friend in friends:
        commandFriend(friend)
    attackSikll()`
			}
        ];
        // 为第19关添加哔哩哔哩视频跳转按钮
        setTimeout(() => {
            const level19Section = document.getElementById('level-19');
            if (level19Section) {
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'video-container';
                buttonContainer.innerHTML = `
                    <h4><i class="fas fa-video"></i> 通关视频参考</h4>
                    <div class="bilibili-btn-container">
                        <a href="https://www.bilibili.com/video/BV1cRqDBuEVj/?spm_id_from=333.1387.homepage.video_card.click&vd_source=4826033e5c6242fb339394c4ea66c111" 
                           target="_blank" 
                           class="bilibili-btn">
                            <i class="fab fa-bilibili"></i> 
                            <span>前往哔哩哔哩观看通关视频</span>
                        </a>
                    </div>
                    <p class="video-caption">点击上方按钮跳转到哔哩哔哩观看完整通关流程</p>
                `;
                level19Section.appendChild(buttonContainer);
            }
        }, 100);
		// 为第78关添加图片
		setTimeout(() => {
            const level78Section = document.getElementById('level-78');
            if (level78Section) {
                const imgContainer = document.createElement('div');
                imgContainer.className = 'equipment-image';
                imgContainer.innerHTML = `
                    <img src="宠物.png" alt="装备参考" style="max-width: 500px; width: 100%; height: auto;">
                    <div class="image-caption">必须带的宠物</div>
                `;
                level78Section.appendChild(imgContainer);
            }
        }, 150);
		// 为第109关添加哔哩哔哩视频跳转按钮
        setTimeout(() => {
            const level109Section = document.getElementById('level-109');
            if (level109Section) {
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'video-container';
                buttonContainer.innerHTML = `
                    <h4><i class="fas fa-video"></i> 通关视频参考</h4>
                    <div class="bilibili-btn-container">
                        <a href="https://www.bilibili.com/video/BV1CNBFBYEN6/?spm_id_from=333.1387.homepage.video_card.click&vd_source=4826033e5c6242fb339394c4ea66c111" 
                           target="_blank" 
                           class="bilibili-btn">
                            <i class="fab fa-bilibili"></i> 
                            <span>前往哔哩哔哩观看通关视频</span>
                        </a>
                    </div>
                    <p class="video-caption">点击上方按钮跳转到哔哩哔哩观看完整通关流程</p>
                `;
                level109Section.appendChild(buttonContainer);
            }
        }, 200);
        // 生成关卡内容
        const levelContent = document.getElementById('levelContent');
        
        levelCodes.forEach(level => {
            const section = document.createElement('section');
            section.className = 'level-section';
            section.id = `level-${level.id}`;
            
            let codeHtml = `<div class="level-header">
                <h3>${level.id}. ${level.name}</h3>
            </div>`;
            
            // 检查是否为多代码块关卡
            if (level.multiCode && level.codes && Array.isArray(level.codes)) {
                // 多代码块布局
                codeHtml += `<div class="code-container multi-code-container">`;
                
                level.codes.forEach((codeBlock, index) => {
                    const codeBlockId = `${level.id}-${index + 1}`;
                    codeHtml += `
                        <div class="code-block-title">${codeBlock.title || ` ${index + 1}`}</div>
                        <div class="sub-code-container">
                            <pre><code id="code-${codeBlockId}"></code></pre>
                            <button class="copy-btn" data-code-id="${codeBlockId}">
                                <i class="far fa-copy"></i> 复制代码
                            </button>
                        </div>
                    `;
                });
                
                codeHtml += `</div>`;
            } else {
                // 单代码块布局
                const codeId = `${level.id}-1`;
                codeHtml += `
                    <div class="code-container">
                        <pre><code id="code-${codeId}"></code></pre>
                        <button class="copy-btn" data-code-id="${codeId}">
                            <i class="far fa-copy"></i> 复制代码
                        </button>
                    </div>
                `;
            }
            
            section.innerHTML = codeHtml;
            
            // 设置代码内容
            if (level.multiCode && level.codes && Array.isArray(level.codes)) {
                // 设置多代码块内容
                level.codes.forEach((codeBlock, index) => {
                    const codeBlockId = `${level.id}-${index + 1}`;
                    const codeElement = section.querySelector(`#code-${codeBlockId}`);
                    if (codeElement) {
                        codeElement.textContent = codeBlock.code;
                    }
                });
            } else {
                // 设置单代码块内容
                const codeId = `${level.id}-1`;
                const codeElement = section.querySelector(`#code-${codeId}`);
                if (codeElement) {
                    codeElement.textContent = level.code;
                }
            }
            
            levelContent.appendChild(section);
        });
        
        // 导航条收起功能
        const levelNav = document.getElementById('levelNav');
        const collapseToggle = document.getElementById('collapseToggle');
        const collapseIcon = document.getElementById('collapseIcon');
        const navHeader = document.querySelector('.nav-header');
        
        // 切换收起状态
        function toggleNavCollapse() {
            levelNav.classList.toggle('collapsed');
            
            // 更新图标和文本
            if (levelNav.classList.contains('collapsed')) {
                collapseIcon.className = 'fas fa-chevron-down';
                collapseToggle.querySelector('.toggle-text').textContent = '展开搜索栏';
            } else {
                collapseIcon.className = 'fas fa-chevron-up';
                collapseToggle.querySelector('.toggle-text').textContent = '收起搜索栏';
                
                // 展开时自动聚焦搜索框
                setTimeout(() => {
                    document.getElementById('searchInput').focus();
                }, 300);
            }
        }
        
        // 点击切换按钮收起/展开
        collapseToggle.addEventListener('click', function(e) {
            e.stopPropagation(); // 防止事件冒泡
            toggleNavCollapse();
        });
        
        // 点击导航标题也可以收起/展开
        navHeader.addEventListener('click', function(e) {
            // 如果点击的不是切换按钮本身
            if (!e.target.closest('.collapse-toggle')) {
                toggleNavCollapse();
            }
        });
        
        // 搜索功能
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');
        const searchStats = document.getElementById('searchStats');
        
        // 初始显示所有关卡
        updateSearchResults(levelCodes);
        
        // 搜索输入事件
        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase().trim();
            
            if (searchTerm === '') {
                // 显示所有关卡
                updateSearchResults(levelCodes);
            } else {
                // 过滤关卡
                const filteredLevels = levelCodes.filter(level => {
                    // 检查关卡名称
                    if (level.name.toLowerCase().includes(searchTerm)) return true;
                    
                    // 检查关卡ID
                    if (level.id.toString().includes(searchTerm)) return true;
                    
                    // 检查单代码块内容
                    if (level.code && level.code.toLowerCase().includes(searchTerm)) return true;
                    
                    // 检查多代码块内容
                    if (level.multiCode && level.codes) {
                        for (let codeBlock of level.codes) {
                            if (codeBlock.code && codeBlock.code.toLowerCase().includes(searchTerm)) return true;
                            if (codeBlock.title && codeBlock.title.toLowerCase().includes(searchTerm)) return true;
                        }
                    }
                    
                    return false;
                });
                
                updateSearchResults(filteredLevels);
            }
            
            // 如果有搜索结果，确保导航条是展开状态
            if (!levelNav.classList.contains('collapsed')) {
                levelNav.classList.remove('collapsed');
            }
        });
        
        // 搜索框获得焦点时展开导航条
        searchInput.addEventListener('focus', function() {
            if (levelNav.classList.contains('collapsed')) {
                toggleNavCollapse();
            }
        });
        
        // 更新搜索结果
        function updateSearchResults(levels) {
            searchResults.innerHTML = '';
            
            if (levels.length === 0) {
                searchResults.innerHTML = '<div class="no-results">未找到匹配的关卡</div>';
                searchResults.classList.remove('hidden');
                searchStats.textContent = '共109个关卡，未找到匹配项';
                return;
            }
            
            levels.forEach(level => {
                const result = document.createElement('a');
                result.href = `#level-${level.id}`;
                result.className = 'level-result';
                result.innerHTML = `
                    <span class="level-id">${level.id}</span>
                    <span class="level-name">${level.name}</span>
                `;
                
                // 添加点击事件，平滑滚动到对应关卡
                result.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    
                    if (targetElement) {
                        targetElement.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                        
                        // 高亮显示当前关卡
                        document.querySelectorAll('.level-section').forEach(section => {
                            section.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.08)';
                        });
                        
                        targetElement.style.boxShadow = '0 0 0 3px rgba(230, 126, 34, 0.3)';
                        
                        // 3秒后移除高亮
                        setTimeout(() => {
                            targetElement.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.08)';
                        }, 3000);
                    }
                });
                
                searchResults.appendChild(result);
            });
            
            searchResults.classList.remove('hidden');
            searchStats.textContent = `共109个关卡，找到109个匹配项`;
        }
        
        // 添加复制功能（事件委托）
        document.addEventListener('click', function(e) {
            const copyBtn = e.target.closest('.copy-btn');
            if (copyBtn) {
                const codeId = copyBtn.getAttribute('data-code-id');
                const codeElement = document.getElementById(`code-${codeId}`);
                if (codeElement) {
                    copyToClipboard(codeElement.textContent);
                }
            }
        });
        
        // 辅助函数：复制到剪贴板
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
            
            // 显示复制成功提示
            showCopyNotification();
        }
        
        // 显示复制成功提示
        const copyNotification = document.getElementById('copyNotification');
        
        function showCopyNotification() {
            copyNotification.classList.add('show');
            setTimeout(() => {
                copyNotification.classList.remove('show');
            }, 3000);
        }
        
        // 检查URL中的锚点，滚动到对应位置
        window.addEventListener('load', function() {
            if (window.location.hash) {
                const targetElement = document.querySelector(window.location.hash);
                if (targetElement) {
                    setTimeout(() => {
                        targetElement.scrollIntoView({ behavior: 'smooth' });
                        
                        // 高亮显示当前关卡
                        targetElement.style.boxShadow = '0 0 0 3px rgba(230, 126, 34, 0.3)';
                        
                        // 3秒后移除高亮
                        setTimeout(() => {
                            targetElement.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.08)';
                        }, 3000);
                    }, 100);
                }
            }
        });
        
        // 为代码容器添加鼠标进入/离开事件，显示/隐藏复制按钮
        document.querySelectorAll('.code-container, .sub-code-container').forEach(container => {
            const copyBtn = container.querySelector('.copy-btn');
            if (copyBtn) {
                container.addEventListener('mouseenter', function() {
                    copyBtn.classList.add('show');
                });
                
                container.addEventListener('mouseleave', function() {
                    copyBtn.classList.remove('show');
                });
            }
        });
        
        // 浮动返回顶部按钮功能
        const floatingTopBtn = document.getElementById('floatingTopBtn');
        
        // 监听滚动事件，显示/隐藏浮动按钮
        window.addEventListener('scroll', function() {
            if (window.scrollY > 300) {
                floatingTopBtn.classList.add('show');
            } else {
                floatingTopBtn.classList.remove('show');
            }
        });
        
        // 点击浮动按钮返回顶部
        floatingTopBtn.addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });
        
        // 初始加载时显示所有关卡
        updateSearchResults(levelCodes);
    </script>
</body>
</html>